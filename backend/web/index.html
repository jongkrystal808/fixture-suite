<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- favicon ÊîæÂú® /usr/share/nginx/html/favicon.ico -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <title>Ê≤ªÂÖ∑ÁÆ°ÁêÜÁ≥ªÁµ±</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Êú¨Âú∞ CSSÔºöÂ∞çÊáâ /usr/share/nginx/html/css/app-main.css -->
  <link rel="stylesheet" href="/css/app-main.css">
</head>

<!-- =========================
     Import Result Modal
========================= -->
<div id="importResultModal" class="hidden">
  <div class="import-modal-backdrop"></div>
  <div class="import-modal">
    <h3 id="importModalTitle">ÂåØÂÖ•ÁµêÊûú</h3>

    <div class="import-modal-summary" id="importModalSummary"></div>

    <pre class="import-modal-errors" id="importModalErrors"></pre>

    <div class="import-modal-actions">
      <button type="button" onclick="closeImportResultModal()">Á¢∫Ë™ç</button>
    </div>
  </div>
</div>

<body class="bg-gray-50 text-gray-900">
        <!-- ÁôªÂÖ•‰ªãÈù¢ -->
      <div id="loginModal" class="modal-backdrop">
        <div class="modal space-y-4">
          <div class="flex items-center justify-between">
            <h3 class="font-semibold text-lg">ÁôªÂÖ•</h3>
            <!-- ‰ΩøÁî® app-auth.js ÁöÑ closeLogin() -->
            <button class="btn btn-ghost text-xs" onclick="closeLogin()">ÈóúÈñâ</button>
          </div>
          <div class="grid gap-3">
            <div class="field">
              <label class="label-xs">Â∏≥Ëôü</label>
              <input id="loginId" class="input" placeholder="Ëº∏ÂÖ•Â∏≥Ëôü" />
            </div>
            <div class="field">
              <label class="label-xs">ÂØÜÁ¢º</label>
              <input id="loginPwd" type="password" class="input" placeholder="Ëº∏ÂÖ•ÂØÜÁ¢º" />
            </div>
            <button class="btn btn-primary" onclick="doLogin()">ÁôªÂÖ•</button>
            <p id="loginMsg" class="text-xs text-gray-500"></p>
          </div>
        </div>
      </div>

        <!-- ÂÆ¢Êà∂ÈÅ∏ÊìáË¶ñÁ™ó -->
        <dialog id="customerSelectModal" class="modal">
          <div class="modal-box space-y-4">
            <h3 class="font-semibold text-lg">Ë´ãÈÅ∏ÊìáÂÆ¢Êà∂</h3>

            <select id="customerSelect" class="select select-bordered w-full">
              <option value="" disabled selected>Ë´ãÈÅ∏ÊìáÂÆ¢Êà∂</option>
            </select>

            <div class="flex justify-end gap-2">
              <button class="btn" onclick="confirmCustomerSelection()">Á¢∫Ë™ç</button>
            </div>
          </div>
        </dialog>

          <!-- È†ÇÈÉ®Â∞éË¶Ω -->
            <header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-gray-200">
            <div class="mx-auto max-w-7xl px-4 py-3 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="h-8 w-8 rounded-xl bg-gray-900 text-white grid place-items-center font-bold">F</div>
                <div>
                  <h1 class="text-lg font-semibold leading-tight">Ê≤ªÂÖ∑ÁÆ°ÁêÜÁ≥ªÁµ±</h1>
                </div>
              </div>
              <div class="flex items-center gap-2">
                <span class="pill border-gray-300" id="clock">--:--</span>
                <!-- ÁõÆÂâçÂÆ¢Êà∂ÔºàÂèØÁõ¥Êé•‰∏ãÊãâÂàáÊèõÔºâ -->
                <select
                  id="currentCustomerSelect"
                  class="pill border-gray-300 bg-white text-sm cursor-pointer hidden"
                  title="ÂàáÊèõÂÆ¢Êà∂"
                  onchange="switchCustomerFromHeader(this.value)">
                  <option value="">--</option>  <!-- ÊîπÊàêÈÄôÊ®£ -->
                </select>

                <span id="currentUserDisplay" class="text-xs text-gray-600">Êú™ÁôªÂÖ•</span>

                <!-- ÁôªÂÖ•ÊåâÈàï -->
                <button class="btn btn-ghost" id="btnLogin" onclick="showLoginModal()">ÁôªÂÖ•</button>

                <!-- ÁôªÂá∫ÊåâÈàïÔºàÈ†êË®≠Èö±ËóèÔºâ -->
                <button class="btn btn-ghost hidden" id="btnLogout" onclick="doLogout()">ÁôªÂá∫</button>
              </div>
            </div>
          </header>


              <!-- ‰∏ªÂÆπÂô® -->
              <main class="mx-auto max-w-7xl p-4 md:p-6 space-y-6">
                <!-- ÂäüËÉΩÂàÜÈ†Å -->
                <nav class="grid grid-cols-2 md:grid-cols-7 gap-2">
                  <button data-tab="dashboard" class="tab tab-active">ÂÑÄË°®Êùø</button>
                  <button data-tab="transactions"  class="tab">‰∫§ÊòìÁôªË®ò</button>
                  <button data-tab="query"    class="tab">Ê≤ªÂÖ∑/Ê©üÁ®ÆÊü•Ë©¢</button>
                  <button data-tab="logs"     class="tab">‰ΩøÁî®/Êõ¥ÊèõË®òÈåÑ</button>
                  <button data-tab="stats"    class="tab">Ê≤ªÂÖ∑ÊÉÖÊ≥ÅÁµ±Ë®à</button>
                  <button data-tab="admin"    class="tab">ÂæåÂè∞ÁÆ°ÁêÜ</button>
                </nav>

                <!-- Áï∂ÂâçÂàáÈ†ÅÊ®ôÈ°åÊ¨Ñ -->
                <div id="activeTabBanner" class="card px-4 py-3 flex items-center justify-between">
                  <div class="flex items-center gap-3">
                    <div class="h-8 w-1.5 rounded-full bg-gray-900"></div>
                    <div class="section-title" id="activeTabTitle">ÂÑÄË°®Êùø</div>
                  </div>
                </div>

                <!-- ============================================================= -->
                <!-- ÂÑÄË°®Êùø Dashboard -->
                <!-- ============================================================= -->
                <section id="tab-dashboard" class="space-y-6">
                  <div class="grid md:grid-cols-3 gap-4">
                    <div class="card p-5">
                      <div class="flex items-center justify-between">
                        <h3 class="font-semibold">‰ªäÊó•Êî∂Êñô</h3>
                        <span class="pill border-green-300 text-green-700 bg-green-50">Âç≥ÊôÇ</span>
                      </div>
                      <p class="text-3xl font-bold mt-2" id="todayIn">0</p>
                      <div class="mt-3 space-y-2" id="todayInList"></div>
                    </div>
                    <div class="card p-5">
                      <div class="flex items-center justify-between">
                        <h3 class="font-semibold">‰ªäÊó•ÈÄÄÊñô</h3>
                        <span class="pill border-blue-300 text-blue-700 bg-blue-50">Âç≥ÊôÇ</span>
                      </div>
                      <p class="text-3xl font-bold mt-2" id="todayOut">0</p>
                      <div class="mt-3 space-y-2" id="todayOutList"></div>
                    </div>
                    <div class="card p-5">
                      <div class="flex items-center justify-between">
                        <h3 class="font-semibold">Âç≥Â∞áÊõ¥ÊèõÊ≤ªÂÖ∑</h3>
                        <button class="btn btn-ghost text-s" onclick="downloadCSV('upcoming.csv', mockUpcomingCSV())">ÂåØÂá∫</button>
                      </div>
                      <div class="mt-3 space-y-2 max-h-40 overflow-auto" id="upcomingList"></div>
                    </div>
                  </div>

                  <div class="card p-5">
                    <div class="flex items-center justify-between mb-3">
                      <h3 class="font-semibold">Â∫´Â≠òÊ¶ÇË¶Ω</h3>
                      <div class="flex items-center gap-2">
                        <input id="searchDash" class="w-48 border rounded-xl px-3 py-1.5 text-sm" placeholder="ÊêúÂ∞ãÊ≤ªÂÖ∑/Ê©üÁ®Æ..." />
                        <button class="btn btn-ghost text-sm" onclick="filterDashboard()">ÁØ©ÈÅ∏</button>
                      </div>
                    </div>
                    <div class="overflow-auto">
                      <table class="min-w-full text-sm">
                        <thead class="text-left text-gray-500">
                          <tr>
                            <th class="py-2 pr-4">Ê≤ªÂÖ∑Á∑®Ëôü</th>
                            <th class="py-2 pr-4">ÂêçÁ®±</th>
                            <th class="py-2 pr-4">Ê©üÁ®Æ</th>
                            <th class="py-2 pr-4">ÂÑ≤‰Ωç</th>
                            <th class="py-2 pr-4">ÁãÄÊÖã</th>
                            <th class="py-2 pr-4">‰ΩøÁî®Ê¨°Êï∏/ÈÄ±Êúü</th>
                            <th class="py-2 pr-4">Ë≤†Ë≤¨‰∫∫</th>
                          </tr>
                        </thead>
                        <tbody id="dashTable"></tbody>
                      </table>
                    </div>
                  </div>
                </section>


                <!-- ============================================================= -->
                <!-- ‰∫§ÊòìÁÆ°ÁêÜ Transactions -->
                <!-- ============================================================= -->
                <section id="tab-transactions" class="hidden space-y-4">

                  <!-- ‰∏ªÂàÜÈ†Å -->
                  <div class="flex gap-2">
                    <button class="subtab subtab-active"
                            onclick="showTransactionSubTab('ttab-register')"
                            data-ttab="register">
                      ‰∫§ÊòìÁôªË®ò
                    </button>

                    <button class="subtab"
                            onclick="showTransactionSubTab('ttab-view-all')"
                            data-ttab="view-all">
                      ‰∫§ÊòìË®òÈåÑ
                    </button>

                    <button class="subtab subtab-active"
                            data-ttab="inventory"
                            onclick="showTransactionSubTab('inventoryTab')">
                      Â∫´Â≠òÊ™¢Ë¶ñ
                    </button>


                  </div>

                  <!-- ============================================================= -->
                  <!-- üîµ ‰∫§ÊòìÁôªË®òÂàÜÈ†Å -->
                  <!-- ============================================================= -->
                  <div id="ttab-register" class="space-y-4">
                    <div class="card p-5 space-y-4">
                      <h3 class="font-semibold text-lg">‰∫§ÊòìÁôªË®ò</h3>

                      <!-- Êìç‰ΩúÊåâÈàï -->
                      <div class="flex gap-2 flex-wrap">
                        <button class="btn bg-green-600 text-white hover:bg-green-500"
                                onclick="toggleTransactionAdd(true)">
                          Êñ∞Â¢û‰∫§ÊòìË®òÈåÑ
                        </button>
                        <label class="btn btn-ghost cursor-pointer">
                          <input id="transactionXlsx" type="file" accept=".xlsx" class="hidden"
                                 onchange="handleTransactionImport(this)" />
                          ÂåØÂÖ•‰∫§ÊòìË®òÈåÑ
                        </label>
                        <button class="btn btn-ghost" onclick="downloadTransactionTemplate()">
                          ‰∏ãËºâÂåØÂÖ•ÁØÑÊú¨
                        </button>
                      </div>

                      <!-- Êñ∞Â¢ûË°®ÂñÆ -->
                      <div id="transactionAddForm" class="hidden border rounded-2xl p-4 bg-blue-50 space-y-4">

                        <!-- Âü∫Êú¨Ë≥áË®ä -->
                        <div class="grid md:grid-cols-5 gap-3">
                          <!-- ‰∫§ÊòìÈ°ûÂûã -->
                          <div class="field">
                            <label class="text-base font-semibold">‰∫§ÊòìÈ°ûÂûã *</label>
                            <select id="transactionDirection" class="input">
                              <option value="receipt">Êî∂Êñô</option>
                              <option value="return">ÈÄÄÊñô</option>
                            </select>
                          </div>

                          <!-- ÂñÆËôü -->
                          <div class="field">
                            <label class="text-base font-semibold">ÂñÆËôü</label>
                            <input id="transactionAddOrder" class="input" placeholder="‰æã: 25123456">
                          </div>

                          <!-- Ê≤ªÂÖ∑ ID -->
                          <div class="field">
                            <label class="text-base font-semibold">Ê≤ªÂÖ∑ ID *</label>
                            <input id="transactionAddFixture" class="input" placeholder="‰æã: C-00001">
                          </div>

                          <!-- Ë®òÈåÑÈ°ûÂûã -->
                          <div class="field">
                            <label class="text-base font-semibold">Ë®òÈåÑÈ°ûÂûã *</label>
                            <select id="transactionAddType" class="input" onchange="toggleTransactionTypeFields()">
                              <option value="batch">ÊâπÈáè (e.g. 1~26)</option>
                              <option value="individual">Â∞ëÈáèÂ∫èËôü (serials)</option>
                              <option value="datecode">Datecode + Êï∏Èáè</option>
                            </select>
                          </div>
                        </div>

                        <!-- ÊâπÈáèÔºöÊµÅÊ∞¥ËôüËµ∑Ë®ñ -->
                        <div id="transactionBatchArea" class="grid md:grid-cols-5 gap-3">
                          <div class="field">
                            <label class="text-base font-semibold">Â∫èËôüËµ∑Âßã *</label>
                            <input id="transactionAddStart" class="input" placeholder="SN001">
                          </div>
                          <div class="field">
                            <label class="text-base font-semibold">Â∫èËôüÁµêÂ∞æ *</label>
                            <input id="transactionAddEnd" class="input" placeholder="SN100">
                          </div>
                        </div>

                        <!-- Â∞ëÈáèÂ∫èËôü -->
                        <div id="transactionIndividualArea" class="hidden grid md:grid-cols-5 gap-3">
                          <div class="field md:col-span-5">
                            <label class="text-base font-semibold">Â∫èËôü (ÈÄóËôüÂàÜÈöî) *</label>
                            <input id="transactionAddSerials" class="input" placeholder="‰æãÂ¶Ç: SN001, SN002, SN003">
                          </div>
                        </div>

                        <!-- Datecode -->
                        <div id="transactionDatecodeArea" class="hidden grid md:grid-cols-5 gap-3">
                          <div class="field md:col-span-1">
                            <label class="text-base font-semibold">Datecode *</label>
                            <input type="text" id="transactionAddDatecode" class="input"
                                   placeholder="‰æãÂ¶Ç: 2024W12, 20241201">
                          </div>
                          <div class="field md:col-span-1">
                            <label class="text-base font-semibold">Êï∏Èáè *</label>
                            <input type="number" id="transactionAddQuantity" class="input"
                                   placeholder="‰æã: 50" min="1">
                          </div>
                        </div>

                        <!-- ‰æÜÊ∫êÈ°ûÂûã (datecode Ê®°ÂºèÂøÖÂ°´) -->
                        <!-- ‰æÜÊ∫êÈ°ûÂûãÔºàÂøÖÂ°´Ôºâ -->
                        <div id="transactionSourceArea" class="field">
                          <label class="text-base font-semibold">‰æÜÊ∫êÈ°ûÂûã *</label>
                          <select id="transactionAddSourceType" class="select select-bordered">
                            <option value="customer_supplied">ÂÆ¢‰æõ</option>
                            <option value="self_purchased">Ëá™Ë≥º</option>
                          </select>
                        </div>

                        <!-- ÂÇôË®ª -->
                        <div class="field">
                          <label class="text-base font-semibold">ÂÇôË®ª</label>
                          <input id="transactionAddNote" class="input">
                        </div>

                        <!-- Êìç‰ΩúÊåâÈàï -->
                        <div class="flex justify-end gap-2">
                          <button class="btn btn-ghost" onclick="toggleTransactionAdd(false)">ÂèñÊ∂à</button>
                          <button class="btn btn-primary" onclick="submitTransaction()">Êèê‰∫§</button>
                        </div>
                      </div>

                      <div class="border-t border-gray-300 my-4"></div>

                      <!-- ÊúÄËøëÁôªË®òË®òÈåÑ -->
                      <div>
                        <h4 class="font-semibold mb-3">ÊúÄËøëÁôªË®òÁöÑ 10 Á≠ÜË®òÈåÑ</h4>
                        <div class="overflow-auto">
                          <table class="min-w-full text-sm">
                            <thead class="text-left text-gray-500">
                              <tr>
                                <th class="py-2 pr-4">ÊôÇÈñì</th>
                                <th class="py-2 pr-4">È°ûÂûã</th>
                                <th class="py-2 pr-4">Ê≤ªÂÖ∑</th>
                                <th class="py-2 pr-4">ÂñÆËôü</th>
                                <th class="py-2 pr-4">Ë®òÈåÑÈ°ûÂûã</th>
                                <th class="py-2 pr-4">Êï∏Èáè</th>
                                <th class="py-2 pr-4">Êìç‰Ωú‰∫∫Âì°</th>
                              </tr>
                            </thead>
                            <tbody id="recentTransactionsTable"></tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ============================================================= -->
                  <!-- üü† Á∏ΩÊ™¢Ë¶ñÂàÜÈ†Å -->
                  <!-- ============================================================= -->
                  <div id="ttab-view-all" class="hidden space-y-4">
                    <div class="card p-5 space-y-4">
                      <h3 class="font-semibold text-lg">Êî∂ / ÈÄÄÊñôÁ∏ΩÊ™¢Ë¶ñ</h3>

                      <!-- Á¨¨‰∏ÄÁ¥öÔºöÊü•Ë©¢Ê®°ÂºèÂàáÊèõ -->
                      <div class="flex gap-2 border-b pb-3">
                        <button class="px-4 py-2 rounded-lg text-sm font-medium transition-all
                                       bg-blue-600 text-white"
                                id="vaMode-all"
                                onclick="switchViewAllMode('all')">
                          ÂÖ®ÈÉ®Êü•Ë©¢
                        </button>
                        <button class="px-4 py-2 rounded-lg text-sm font-medium transition-all
                                       bg-gray-100 text-gray-600 hover:bg-gray-200"
                                id="vaMode-serial"
                                onclick="switchViewAllMode('serial')">
                          Â∫èËôüÊü•Ë©¢
                        </button>
                        <button class="px-4 py-2 rounded-lg text-sm font-medium transition-all
                                       bg-gray-100 text-gray-600 hover:bg-gray-200"
                                id="vaMode-datecode"
                                onclick="switchViewAllMode('datecode')">
                          DatecodeÊü•Ë©¢
                        </button>
                      </div>

                      <!-- Á¨¨‰∫åÁ¥öÔºöÁØ©ÈÅ∏Ê¢ù‰ª∂ -->
                      <div id="vaFilterArea">

                        <!-- üîπ Â∫èËôüÊü•Ë©¢Ê®°ÂºèÔºàÊï¥ÂêàËá™Â∫èËôüÊ™¢Ë¶ñÔºâ -->
                        <div id="vaSerialFilters" class="hidden space-y-4">
                          <!-- Êî∂ÈÄÄÊñôÈ°ûÂûã + ÊâπÈáèÈ°ûÂûã -->
                          <div class="flex gap-4 items-center">
                            <div class="flex gap-2">
                              <span class="text-sm text-gray-600">Êî∂ÈÄÄÊñôÈ°ûÂûãÔºö</span>
                              <label class="inline-flex items-center">
                                <input type="radio" name="vaSerialTxType" value="" checked class="mr-1">
                                <span class="text-sm">ÂÖ®ÈÉ®</span>
                              </label>
                              <label class="inline-flex items-center">
                                <input type="radio" name="vaSerialTxType" value="receipt" class="mr-1">
                                <span class="text-sm">Êî∂Êñô</span>
                              </label>
                              <label class="inline-flex items-center">
                                <input type="radio" name="vaSerialTxType" value="return" class="mr-1">
                                <span class="text-sm">ÈÄÄÊñô</span>
                              </label>
                            </div>
                          </div>

                          <!-- ÊêúÁ¥¢Ê¨Ñ‰Ωç -->
                          <div class="grid md:grid-cols-6 gap-3">
                            <!-- Êó•ÊúüÂå∫Èó¥ -->
                            <div class="field md:col-span-2">
                              <label class="text-sm text-gray-600">Êó•ÊúüÂçÄÈñì</label>
                              <div class="flex items-center gap-2">
                                <input type="date" id="vaSerialDateFrom" class="input text-sm flex-1" placeholder="ÈñãÂßãÊó•Êúü">
                                <span class="text-gray-400">‚Äî</span>
                                <input type="date" id="vaSerialDateTo" class="input text-sm flex-1" placeholder="ÁµêÊùüÊó•Êúü">
                              </div>
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Ê≤ªÂÖ∑Á∑®Ëôü</label>
                              <input id="vaSerialFixture" class="input" placeholder="C-00001"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">ÂñÆËôü</label>
                              <input id="vaSerialOrderNo" class="input" placeholder="25123456"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Â∫èËôü</label>
                              <input id="vaSerialSerial" class="input" placeholder="SN001"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Êìç‰Ωú‰∫∫Âì°</label>
                              <input id="vaSerialOperator" class="input" placeholder="Â∑•Ëôü"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>
                          </div>
                        </div>

                        <!-- üî∏ DatecodeÊü•Ë©¢Ê®°Âºè -->
                        <div id="vaDatecodeFilters" class="hidden space-y-4">
                          <!-- Êî∂ÈÄÄÊñôÈ°ûÂûã -->
                          <div class="flex gap-2 items-center">
                            <span class="text-sm text-gray-600">Êî∂ÈÄÄÊñôÈ°ûÂûãÔºö</span>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaDatecodeTxType" value="" checked class="mr-1">
                              <span class="text-sm">ÂÖ®ÈÉ®</span>
                            </label>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaDatecodeTxType" value="receipt" class="mr-1">
                              <span class="text-sm">Êî∂Êñô</span>
                            </label>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaDatecodeTxType" value="return" class="mr-1">
                              <span class="text-sm">ÈÄÄÊñô</span>
                            </label>
                          </div>

                          <!-- ÊêúÁ¥¢Ê¨Ñ‰Ωç -->
                          <div class="grid md:grid-cols-6 gap-3">
                            <!-- Êó•ÊúüÂå∫Èó¥ -->
                            <div class="field md:col-span-2">
                              <label class="text-sm text-gray-600">Êó•ÊúüÂçÄÈñì</label>
                              <div class="flex items-center gap-2">
                                <input type="date" id="vaDatecodeDateFrom" class="input text-sm flex-1" placeholder="ÈñãÂßãÊó•Êúü">
                                <span class="text-gray-400">‚Äî</span>
                                <input type="date" id="vaDatecodeDateTo" class="input text-sm flex-1" placeholder="ÁµêÊùüÊó•Êúü">
                              </div>
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Ê≤ªÂÖ∑Á∑®Ëôü</label>
                              <input id="vaDatecodeFixture" class="input" placeholder="C-00001"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">ÂñÆËôü</label>
                              <input id="vaDatecodeOrderNo" class="input" placeholder="25123456"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Datecode</label>
                              <input id="vaDatecodeDatecode" class="input" placeholder="2024W12"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Êìç‰Ωú‰∫∫Âì°</label>
                              <input id="vaDatecodeOperator" class="input" placeholder="Â∑•Ëôü"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>
                          </div>
                        </div>

                        <!-- üî∑ ÂÖ®ÈÉ®Êü•Ë©¢Ê®°Âºè -->
                        <div id="vaAllFilters" class="space-y-4">
                          <!-- Êî∂ÈÄÄÊñôÈ°ûÂûã -->
                          <div class="flex gap-2 items-center">
                            <span class="text-sm text-gray-600">Êî∂ÈÄÄÊñôÈ°ûÂûãÔºö</span>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaAllTxType" value="" checked class="mr-1">
                              <span class="text-sm">ÂÖ®ÈÉ®</span>
                            </label>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaAllTxType" value="receipt" class="mr-1">
                              <span class="text-sm">Êî∂Êñô</span>
                            </label>
                            <label class="inline-flex items-center">
                              <input type="radio" name="vaAllTxType" value="return" class="mr-1">
                              <span class="text-sm">ÈÄÄÊñô</span>
                            </label>
                          </div>

                          <!-- ÊêúÁ¥¢Ê¨Ñ‰Ωç -->
                          <div class="grid md:grid-cols-6 gap-3">
                            <!-- Êó•ÊúüÂå∫Èó¥ -->
                            <div class="field md:col-span-2">
                              <label class="text-sm text-gray-600">Êó•ÊúüÂçÄÈñì</label>
                              <div class="flex items-center gap-2">
                                <input type="date" id="vaAllDateFrom" class="input text-sm flex-1" placeholder="ÈñãÂßãÊó•Êúü">
                                <span class="text-gray-400">‚Äî</span>
                                <input type="date" id="vaAllDateTo" class="input text-sm flex-1" placeholder="ÁµêÊùüÊó•Êúü">
                              </div>
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Ê≤ªÂÖ∑Á∑®Ëôü</label>
                              <input id="vaAllFixture" class="input" placeholder="C-00001"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">ÂñÆËôü</label>
                              <input id="vaAllOrderNo" class="input" placeholder="25123456"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Datecode</label>
                              <input id="vaAllDatecode" class="input" placeholder="2024W12"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Â∫èËôü</label>
                              <input id="vaAllSerial" class="input" placeholder="SN001"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>

                            <div class="field">
                              <label class="text-sm text-gray-600">Êìç‰Ωú‰∫∫Âì°</label>
                              <input id="vaAllOperator" class="input" placeholder="Â∑•Ëôü"
                                     onkeypress="handleViewSearchKeypress(event, 'viewall')">
                            </div>
                          </div>
                        </div>

                      </div>

                      <!-- Êìç‰ΩúÊåâÈàï -->
                      <div class="flex gap-2">
                        <button class="btn bg-blue-600 text-white" onclick="loadTransactionViewAll(1)">
                          Êü•Ë©¢
                        </button>
                        <!-- ÂåØÂá∫ÊåâÈàïÂè™Âú®ÂÖ®ÈÉ®Êü•Ë©¢Ê®°ÂºèÈ°ØÁ§∫ -->
                        <button id="btnExportSummary" class="btn btn-ghost" onclick="exportViewAllSummary()">
                          ÂåØÂá∫ÊëòË¶Å
                        </button>
                        <button id="btnExportDetailed" class="btn btn-ghost" onclick="exportViewAllDetailed()">
                          ÂåØÂá∫Ë©≥Á¥∞
                        </button>

                        <button class="btn btn-ghost" onclick="clearViewAllFilters()">
                          Ê∏ÖÁ©∫
                        </button>

                      </div>

                      <!-- ÂàÜÈ†ÅÊåâÈàï -->
                      <div id="viewAllPagination"
                         class="flex items-center gap-2 mt-4 justify-center">

                      <button class="btn btn-xs"
                              onclick="viewAllPager.go('first')">¬´</button>

                      <button class="btn btn-xs"
                              onclick="viewAllPager.go('prev')">‰∏ä‰∏ÄÈ†Å</button>

                      <span class="px-3 text-sm text-gray-600">
                        Á¨¨ <span id="viewAllPageNow">1</span> /
                        <span id="viewAllPageMax">1</span> È†Å
                      </span>

                      <button class="btn btn-xs"
                              onclick="viewAllPager.go('next')">‰∏ã‰∏ÄÈ†Å</button>

                      <button class="btn btn-xs"
                              onclick="viewAllPager.go('last')">¬ª</button>

                    </div>


                      <!-- Ë°®Ê†º -->
                      <div class="overflow-auto">
                        <table id="viewAllTable" class="min-w-full text-sm">
                          <thead id="viewAllTableHead" class="text-left text-gray-500">
                            <!-- Âä®ÊÄÅË°®Â§¥ -->
                          </thead>
                          <tbody id="viewAllTableBody"></tbody>
                        </table>
                      </div>
                    </div>
                  </div>

                  <!-- ===================== -->
                  <!-- ‚òÖ Â∫´Â≠òÊ™¢Ë¶ñ TAB -->
                  <!-- ===================== -->
                  <div id="inventoryTab" class="hidden space-y-4">

                      <!-- Header -->
                      <div class="card p-5 space-y-4">
                        <div class="flex items-center justify-between">
                          <h3 class="font-semibold text-lg">Â∫´Â≠òÊ™¢Ë¶ñ</h3>

                          <div class="flex gap-2">
                            <button
                              type="button"
                              class="btn btn-ghost"
                              onclick="loadInventoryOverview(1)">
                              Êü•Ë©¢/Âà∑Êñ∞
                            </button>
                          </div>
                        </div>

                        <!-- Filters -->
                        <div class="grid md:grid-cols-6 gap-3 items-end">
                          <div class="field md:col-span-2">
                            <label class="text-base font-semibold">Ê≤ªÂÖ∑Á∑®Ëôü</label>
                            <input id="invSearchKeyword" class="input" placeholder="‰æãÔºöC-00001"
                                   onkeydown="if(event.key==='Enter'){
                                       event.preventDefault();
                                        loadInventoryOverview(1);}">
                          </div>

                          <div class="field md:col-span-2">
                            <label class="text-base font-semibold">ÊØèÈ†ÅÁ≠ÜÊï∏</label>
                            <select id="invPageSize"
                                    class="input"
                                    onchange="loadInventoryOverview(1);">
                              <option value="10">10</option>
                              <option value="20">20</option>
                            </select>
                          </div>

                          <div class="field md:col-span-2">
                           <!-- Pagination -->
                            <!-- ÂàÜÈ†ÅÊåâÈàï -->
                            <div id="inventoryPagination"
                                 class="flex items-center gap-2 mt-4 justify-center">

                              <button class="btn btn-xs"
                                      onclick="inventoryPager.go('first')">¬´</button>

                              <button class="btn btn-xs"
                                      onclick="inventoryPager.go('prev')">‰∏ä‰∏ÄÈ†Å</button>

                              <span class="px-3 text-sm text-gray-600">
                                Á¨¨ <span id="invPageNow">1</span> /
                                <span id="invPageMax">1</span> È†Å
                              </span>

                              <button class="btn btn-xs"
                                      onclick="inventoryPager.go('next')">‰∏ã‰∏ÄÈ†Å</button>

                              <button class="btn btn-xs"
                                      onclick="inventoryPager.go('last')">¬ª</button>

                            </div>
                          </div>
                        </div>

                        <!-- Table -->
                        <div class="overflow-auto border rounded-xl">
                          <table class="min-w-full text-sm">
                            <thead class="text-left text-gray-500 bg-gray-50">
                              <tr>
                                <th class="py-2 px-3 text-left font-mono">Ê≤ªÂÖ∑</th>
                                <th class="py-2 px-3 text-left">ÂêçÁ®±</th>
                                <th class="py-2 px-3 text-right">Á∏ΩÂú®Â∫´</th>
                                <th class="py-2 px-3 text-right">Ëá™Ë≥º</th>
                                <th class="py-2 px-3 text-right">ÂÆ¢‰æõ</th>
                                <th class="py-2 px-3 text-right">Â∑≤ÈÄÄ</th>
                                <th class="py-2 px-3 text-center">Êìç‰Ωú</th>

                              </tr>
                            </thead>

                            <!-- JS render -->
                            <tbody id="inventoryTableBody" class="divide-y divide-gray-100"></tbody>
                          </table>
                        </div>

                      </div>
                    </div>


                </section>


                <!-- ============================================================= -->
                <!-- Ê≤ªÂÖ∑/Ê©üÁ®ÆÊü•Ë©¢  Query -->
                <!-- ============================================================= -->
                <section id="tab-query" class="hidden space-y-4">
                      <div class="card p-5 space-y-4">
                        <h3 class="font-semibold text-lg">Ê≤ªÂÖ∑ÔºèÊ©üÁ®ÆÊü•Ë©¢</h3>

                        <!-- Êü•Ë©¢È°ûÂûã -->
                        <div class="flex gap-4 items-center">
                          <label class="font-semibold">Êü•Ë©¢È°ûÂûãÔºö</label>
                          <select id="queryType" class="input w-60" onchange="switchQueryType()">
                            <option value="fixture">Ê≤ªÂÖ∑Êü•Ë©¢</option>
                            <option value="model">Ê©üÁ®ÆÊü•Ë©¢</option>
                          </select>
                        </div>

                        <!-- ====================================================== -->
                        <!-- üîµ Ê≤ªÂÖ∑Êü•Ë©¢ -->
                        <!-- ====================================================== -->
                        <div id="fixtureQueryArea" class="space-y-3">

                            <div class="flex items-center justify-between gap-4 mb-4">

                              <!-- Â∑¶ÂÅ¥ÔºöÊêúÂ∞ã -->
                              <div class="flex items-center gap-4">
                                <div>
                                  <span class="query-label">Ê≤ªÂÖ∑ÊêúÂ∞ãÔºö</span>
                                  <input id="fixtureSearch"
                                         class="query-input"
                                         placeholder="Ëº∏ÂÖ•Ê≤ªÂÖ∑Á∑®Ëôü / ÂêçÁ®±"
                                         oninput="
                                           fixtureQueryPage = 1;
                                           debounceLoadFixtures();
                                         ">
                                </div>

                                <button
                                  class="btn btn-primary"
                                  onclick="fixtureQueryPage = 1; loadFixturesQuery();">
                                  ÊêúÂ∞ã
                                </button>
                                <div id="fixtureQueryPagination"
                                   class="flex items-center gap-2">

                                <button class="btn btn-xs"
                                        onclick="fixtureQueryPager.go('first')">
                                  ¬´
                                </button>

                                <button class="btn btn-xs"
                                        onclick="fixtureQueryPager.go('prev')">
                                  ‰∏ä‰∏ÄÈ†Å
                                </button>

                                <span class="px-3 text-sm text-gray-600 whitespace-nowrap">
                                  Á¨¨ <span id="fixturePageNow">1</span> /
                                  <span id="fixturePageMax">1</span> È†Å
                                </span>

                                <button class="btn btn-xs"
                                        onclick="fixtureQueryPager.go('next')">
                                  ‰∏ã‰∏ÄÈ†Å
                                </button>

                                <button class="btn btn-xs"
                                        onclick="fixtureQueryPager.go('last')">
                                  ¬ª
                                </button>
                              </div>

                              </div>



                            </div>

                          <div class="overflow-x-auto border rounded-lg shadow-sm">
                            <table class="min-w-full text-sm text-center border-collapse">
                              <thead class="text-gray-700 bg-gray-50 border-b">
                                <tr>
                                  <th class="py-2 px-4 w-24">Ê≤ªÂÖ∑Á∑®Ëôü</th>
                                  <th class="py-2 px-4 w-32">ÂêçÁ®±</th>
                                  <th class="py-2 px-4 w-32">È°ûÂûã</th>
                                  <th class="py-2 px-4 w-44">Â∫´Â≠ò(Ëá™Ë≥º/ÂÆ¢‰æõ/Á∏Ω)</th>
                                  <th class="py-2 px-4 w-24">ÂÑ≤‰Ωç</th>
                                  <th class="py-2 px-4 w-32">Ë≤†Ë≤¨‰∫∫</th>
                                  <th class="py-2 px-4 w-48">ÂÇôË®ª</th>
                                </tr>
                              </thead>
                              <tbody id="fixtureTable" class="divide-y divide-gray-100 text-gray-800"></tbody>
                            </table>

                          </div>
                        </div>

                        <!-- ====================================================== -->
                        <!-- üîµ Ê©üÁ®ÆÊü•Ë©¢ -->
                        <!-- ====================================================== -->
                        <div id="modelQueryArea" class="hidden space-y-3">

                          <div class="flex gap-3">
                            <input id="modelSearch"
                               class="input w-64"
                               placeholder="Ëº∏ÂÖ•Ê©üÁ®Æ‰ª£Á¢ºÊàñÂêçÁ®±"
                               oninput="
                                 modelQueryPage = 1;
                                 loadModelsQuery();" />


                            <button
                              class="btn btn-primary"
                              onclick="
                                modelQueryPage = 1;
                                loadModelsQuery();">
                              Êü•Ë©¢
                            </button>

                          </div>

                          <div class="overflow-x-auto border rounded-lg shadow-sm">
                            <table class="min-w-full text-sm text-center border-collapse">
                              <thead class="text-gray-700 bg-gray-50 border-b">
                                <tr>
                                  <th class="py-2 px-4 w-32">Ê©üÁ®Æ‰ª£Á¢º</th>
                                  <th class="py-2 px-4 w-40">ÂêçÁ®±</th>
                                  <th class="py-2 px-4 w-64">ÂÇôË®ª</th>
                                  <th class="py-2 px-4 w-24">Êìç‰Ωú</th>
                                </tr>
                              </thead>
                              <tbody id="modelTable" class="divide-y divide-gray-100 text-gray-800"></tbody>
                            </table>

                            <div id="modelQueryPagination"
                                 class="flex gap-2 mt-3 justify-center"></div>
                          </div>

                          <!-- ====================================================== -->
                          <!-- ‰∏âÊÆµÂºè UIÔºöÁ´ôÈªûÁ∂ÅÂÆö + Ê≤ªÂÖ∑ÈúÄÊ±ÇË®≠ÂÆö -->
                          <!-- ====================================================== -->
                          <div id="msNoModelHint"
                               class="text-center text-gray-500 py-5">
                          </div>

                          <div id="msContent" class="hidden grid grid-cols-2 gap-6 mt-4">

                            <!-- ====================================================== -->
                            <!-- Â∑¶ÂÅ¥ÔºöÁ´ôÈªûÁ∂ÅÂÆö -->
                            <!-- ====================================================== -->
                            <div class="space-y-4">

                              <h4 class="font-semibold text-lg">Â∑≤Á∂ÅÂÆöÁ´ôÈªû</h4>

                              <div class="overflow-x-auto border rounded-lg shadow-sm">
                                <table class="min-w-full text-sm">
                                  <thead class="bg-gray-50 text-gray-600">
                                    <tr>
                                      <th class="py-2 px-3">Á´ôÈªû‰ª£Á¢º</th>
                                      <th class="py-2 px-3">ÂêçÁ®±</th>
                                      <th class="py-2 px-3">Ê≤ªÂÖ∑ÈúÄÊ±Ç</th>
                                      <th class="py-2 px-3">Êìç‰Ωú</th>
                                    </tr>
                                  </thead>
                                  <tbody id="msBoundTable"></tbody>
                                </table>
                              </div>

                              <h4 class="font-semibold text-lg mt-6">ÂèØÁ∂ÅÂÆöÁ´ôÈªû</h4>

                              <div class="overflow-x-auto border rounded-lg shadow-sm">
                                <table class="min-w-full text-sm">
                                  <thead class="bg-gray-50 text-gray-600">
                                    <tr>
                                      <th class="py-2 px-3">Á´ôÈªû‰ª£Á¢º</th>
                                      <th class="py-2 px-3">ÂêçÁ®±</th>
                                      <th class="py-2 px-3">Êìç‰Ωú</th>
                                    </tr>
                                  </thead>
                                  <tbody id="msAvailableTable"></tbody>
                                </table>
                              </div>
                            </div>

                            <!-- ====================================================== -->
                            <!-- Âè≥ÂÅ¥ÔºöÊ≤ªÂÖ∑ÈúÄÊ±ÇË®≠ÂÆö -->
                            <!-- ====================================================== -->
                            <div class="space-y-4">

                              <h4 class="font-semibold text-lg">
                                Ê≤ªÂÖ∑ÈúÄÊ±ÇË®≠ÂÆöÔºö<span id="reqStationLabel" class="text-indigo-600"></span>
                              </h4>

                              <!-- Êñ∞Â¢ûÊ≤ªÂÖ∑ÈúÄÊ±ÇÊåâÈàï -->
                              <button class="btn btn-primary btn-sm"
                                      onclick="openRequirementModal('create')">
                                ‚ûï Êñ∞Â¢ûÊ≤ªÂÖ∑ÈúÄÊ±Ç
                              </button>

                              <!-- Â∑≤Ë®≠ÂÆöÊ≤ªÂÖ∑ÈúÄÊ±Ç -->
                              <div class="overflow-x-auto border rounded-lg shadow-sm">
                                <table class="min-w-full text-sm">
                                  <thead class="bg-gray-50 text-gray-600">
                                    <tr>
                                      <th class="py-2 px-3">Ê≤ªÂÖ∑ ID</th>
                                      <th class="py-2 px-3">ÂêçÁ®±</th>
                                      <th class="py-2 px-3">ÈúÄÊ±ÇÊï∏</th>
                                      <th class="py-2 px-3">ÂÇôË®ª</th>
                                      <th class="py-2 px-3">Êìç‰Ωú</th>
                                    </tr>
                                  </thead>
                                  <tbody id="reqTable"></tbody>
                                </table>
                              </div>

                            </div>
                          </div>
                        </div>
                      </div>
                    </section>


                <!-- ============================================================= -->
                <!-- Ê≤ªÂÖ∑ÊÉÖÊ≥ÅÁµ±Ë®à Stats -->
                <!-- ============================================================= -->
                <section id="tab-stats" class="hidden space-y-4">
                  <!-- Áµ±Ë®àÂç°Áâá -->
                  <div class="grid md:grid-cols-4 gap-4">
                    <div class="card p-5 stat-card">
                      <div class="text-sm opacity-90">Á∏ΩÊ≤ªÂÖ∑Êï∏Èáè</div>
                      <div class="text-3xl font-bold mt-2" id="statTotalFixtures">0</div>
                    </div>
                    <div class="card p-5 bg-gradient-to-br from-green-400 to-emerald-600 text-white">
                      <div class="text-sm opacity-90">Ê≠£Â∏∏‰ΩøÁî®‰∏≠</div>
                      <div class="text-3xl font-bold mt-2" id="statActiveFixtures">0</div>
                    </div>
                    <div class="card p-5 bg-gradient-to-br from-amber-400 to-orange-600 text-white">
                      <div class="text-sm opacity-90">Â£ΩÂëΩÊú™ÈÅîÊ®ô</div>
                      <div class="text-3xl font-bold mt-2" id="statUnderLifespan">0</div>
                    </div>
                    <div class="card p-5 bg-gradient-to-br from-red-400 to-rose-600 text-white">
                      <div class="text-sm opacity-90">Âç≥Â∞áÊõ¥Êèõ</div>
                      <div class="text-3xl font-bold mt-2" id="statNeedReplacement">0</div>
                    </div>
                  </div>

                  <!-- ‰∏çËÄêÁî®Ê≤ªÂÖ∑Ê∏ÖÂñÆ -->
                  <div class="card p-5 space-y-4">
                    <div class="flex items-center justify-between">
                      <h3 class="font-semibold">‰∏çËÄêÁî®Ê≤ªÂÖ∑Ê∏ÖÂñÆ(Â£ΩÂëΩÊú™ÈÅîÈ†êË®≠ÂÄº)</h3>
                      <button class="btn btn-ghost text-sm" onclick="downloadCSV('undurable_fixtures.csv', toCSV(getUndurableFixtures()))">ÂåØÂá∫Ê∏ÖÂñÆ</button>
                    </div>
                    <div class="overflow-auto">
                      <table class="min-w-full text-sm">
                        <thead class="text-left text-gray-500">
                          <tr>
                            <th class="py-2 pr-4">Ê≤ªÂÖ∑Á∑®Ëôü</th>
                            <th class="py-2 pr-4">ÂêçÁ®±</th>
                            <th class="py-2 pr-4">È†êÊúüÂ£ΩÂëΩ</th>
                            <th class="py-2 pr-4">ÂØ¶Èöõ‰ΩøÁî®</th>
                            <th class="py-2 pr-4">ÈÅîÊàêÁéá</th>
                            <th class="py-2 pr-4">Ë≠¶Á§∫Á≠âÁ¥ö</th>
                            <th class="py-2 pr-4">Ë≤†Ë≤¨‰∫∫</th>
                            <th class="py-2 pr-4">Êìç‰Ωú</th>
                          </tr>
                        </thead>
                        <tbody id="undurableTable"></tbody>
                      </table>
                      <div id="undurablePagination" class="flex justify-center mt-4"></div>
                    </div>
                  </div>
                </section>


                <!-- ============================================================= -->
                <!-- ‰ΩøÁî®/Êõ¥ÊèõË®òÈåÑ Usage/Replacement -->
                <!-- ============================================================= -->
                <section id="tab-logs" class="hidden space-y-4">

                  <!-- Â≠êÂàÜÈ†Å -->
                  <div class="flex gap-2">
                    <button class="subtab subtab-active" data-logtab="usage">‰ΩøÁî®Ë®òÈåÑ</button>
                    <button class="subtab" data-logtab="replacement">Êõ¥ÊèõË®òÈåÑ</button>
                  </div>

                  <!-- ========================================================= -->
                  <!-- üîµ ‰ΩøÁî®Ë®òÈåÑ TAB v4.0 -->
                  <!-- ========================================================= -->
                  <div id="logtab-usage" class="space-y-4">
                    <div class="card p-5 space-y-4">

                      <h3 class="font-semibold text-lg">‰ΩøÁî®Ë®òÈåÑ</h3>

                      <!-- Êñ∞Â¢ûË°®ÂñÆ -->
                      <div class="flex gap-2 flex-wrap">
                        <button class="btn bg-yellow-600 text-white hover:bg-yellow-500" onclick="toggleUsageAdd(true)">
                            Êñ∞Â¢û‰ΩøÁî®Ë®òÈåÑ
                        </button>
                        <label class="btn btn-ghost cursor-pointer">
                          <input id="usageXlsx" type="file" accept=".xlsx" class="hidden"
                                 onchange="handleUsageImport(this)" />
                          ÂåØÂÖ• Excel(.xlsx)
                        </label>

                        <button class="btn btn-ghost" onclick="downloadUsageTemplate()">
                            ‰∏ãËºâÁØÑÊú¨
                        </button>
                      </div>

                      <!-- Êñ∞Â¢ûË°®ÂñÆ -->
                      <div id="usageAddForm" class="hidden border rounded-2xl p-4 bg-yellow-50 space-y-3">
                          <div class="grid md:grid-cols-6 gap-3">

                            <!-- Ê©üÁ®Æ -->
                            <div class="field">
                              <label class="text-base font-semibold">Ê©üÁ®Æ ID *</label>
                              <input
                                id="usageAddModel"
                                class="input"
                                placeholder="‰æã: AWK"
                                autocomplete="off"
                              />
                            </div>

                            <!-- Á´ôÈªûÔºàÂøÖÈ†àÈÅ∏Ôºâ -->
                            <div class="field">
                              <label class="text-base font-semibold">Á´ôÈªû ID *</label>
                              <select id="usageAddStation" class="input">
                                <option value="">Ë´ãÂÖàÈÅ∏ÊìáÊ©üÁ®Æ</option>
                              </select>
                            </div>

                            <!-- Ê≤ªÂÖ∑ÔºàÂè™ËÉΩÈÅ∏ÁöÑ autocompleteÔºâ -->
                            <div class="field relative">
                              <label class="text-base font-semibold">Ê≤ªÂÖ∑ ID *</label>

                              <input
                                id="usageAddFixture"
                                class="input w-full"
                                placeholder="Ë´ãÂæûÊ∏ÖÂñÆÈÅ∏ÊìáÊ≤ªÂÖ∑"
                                autocomplete="off"
                              />

                              <!-- üîΩ Autocomplete Dropdown -->
                              <div
                                id="usageFixtureDropdown"
                                class="absolute left-0 right-0 z-50 mt-1 bg-white border rounded shadow hidden max-h-56 overflow-auto"
                              ></div>
                            </div>

                            <!-- ‰ΩøÁî®Ê¨°Êï∏ -->
                            <div class="field">
                              <label class="text-base font-semibold">‰ΩøÁî®Ê¨°Êï∏ *</label>
                              <input
                                id="usageAddCount"
                                type="number"
                                class="input"
                                value="1"
                                min="1"
                              />
                            </div>

                            <!-- Êìç‰Ωú‰∫∫Âì° -->
                            <div class="field">
                              <label class="text-base font-semibold">Êìç‰Ωú‰∫∫Âì° *</label>
                              <input
                                id="usageAddOperator"
                                class="input"
                                placeholder="È†êË®≠ÁôªÂÖ•ËÄÖ"
                              />
                            </div>

                            <!-- ‰ΩøÁî®ÊôÇÈñì -->
                            <div class="field">
                              <label class="text-base font-semibold">‰ΩøÁî®ÊôÇÈñì *</label>
                              <input
                                id="usageAddTime"
                                type="datetime"
                                class="input"
                              />
                            </div>

                          </div>

                        <!-- Record Level -->
                        <div class="grid md:grid-cols-6 gap-3">

                          <div class="field">
                            <label class="text-base font-semibold">Ë®òÈåÑÂ±§Á¥ö *</label>
                            <select id="usageAddLevel" class="input" onchange="toggleUsageSerialInputs()">
                              <option value="fixture">Ê≤ªÂÖ∑Datecode</option>
                              <option value="individual">Ê≤ªÂÖ∑ÂÄãÂà•Â∫èËôü</option>
                              <option value="batch">Ê≤ªÂÖ∑ÊâπÈáèÂ∫èËôü</option>
                            </select>
                          </div>

                             <!-- ÂÄãÂà•Ë®òÈåÑ -->
                          <div id="usageSerialSingleField" class="field hidden">
                            <label class="label-xs">Â∫èËôü(ÈÄóËôüÂàÜÈöî) *</label>
                            <input id="usageAddSerials" class="input" placeholder="SN001, SN002..." />
                          </div>

                            <!-- ÊâπÈáèË®òÈåÑ -->
                          <div id="usageSerialBatchField" class="field hidden ">
                           <div class="field">
                              <label class="text-base font-semibold">Â∫èËôüËµ∑Âßã *</label>
                              <input id="usageAddSerialStart" class="input" placeholder="SN001">
                          </div>
                            <div class="field">
                               <label class="text-base font-semibold">Â∫èËôüÁµêÂ∞æ *</label>
                               <input id="usageAddSerialEnd" class="input" placeholder="SN100">
                            </div>
                          </div>

                        </div>

                        <div class="field">
                          <label class="text-base font-semibold">ÂÇôË®ª</label>
                          <input id="usageAddNote" class="input" />
                        </div>

                        <div class="flex justify-end gap-2">
                          <button class="btn btn-ghost" onclick="toggleUsageAdd(false)">ÂèñÊ∂à</button>
                          <button class="btn btn-primary" onclick="submitUsageLog()">Êèê‰∫§</button>
                        </div>
                      </div>

                        <div class="border-t border-gray-300 my-4"></div>


                        <!-- Êü•Ë©¢ÂçÄ -->
                      <div class="border rounded-2xl p-4 bg-white space-y-4">
                          <div class="flex flex-wrap items-end gap-3">
                              <div class="flex items-center gap-2">
                              <input id="usageSearchDateFrom" type="date" class="input w-40" />
                              <span class="text-gray-400">‚Äî</span>
                              <input id="usageSearchDateTo" type="date" class="input w-40" />
                            </div>

                            <!-- Âø´ÈÄüÊó•Êúü -->
                            <div class="flex gap-1">
                              <button class="btn btn-xs btn-outline" onclick="quickDateRange('today')">‰ªäÂ§©</button>
                              <button class="btn btn-xs btn-outline" onclick="quickDateRange('yesterday')">Êò®Â§©</button>
                              <button class="btn btn-xs btn-outline" onclick="quickDateRange('7days')">ÊúÄËøë 7 Â§©</button>
                            </div>

                          </div>
                          <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                              <div class="field">
                                  <input id="usageSearchFixture" class="input" placeholder="Ê≤ªÂÖ∑ ID" />
                              </div>

                              <div class="field">
                                  <input id="usageSearchSerial" class="input" placeholder="Ê≤ªÂÖ∑Â∫èËôü" />
                              </div>

                              <div class="field">
                                  <input id="usageSearchStation" class="input" placeholder="Á´ôÈªû ID" />
                              </div>

                              <div class="field">
                                  <input id="usageSearchModel" class="input" placeholder="Ê©üÁ®Æ ID" />
                              </div>

                              <div class="field">
                                  <input id="usageSearchOperator" class="input" placeholder="Âì°Â∑•Â∑•Ëôü" />
                              </div>

                              <button class="btn bg-gray-400 w-full" onclick="loadUsageLogs()">Êü•Ë©¢/Âà∑Êñ∞</button>
                        </div>

                      </div>

                      <!-- ‰ΩøÁî®Ë®òÈåÑË°®Ê†º -->
                      <div class="overflow-auto">
                        <table class="min-w-full text-sm">
                          <thead class="text-left text-gray-500">
                          <tr>
                            <th class="py-2 pr-4">Êó•Êúü</th>
                            <th class="py-2 pr-4">Ê≤ªÂÖ∑</th>
                            <th class="py-2 pr-4">Â∫èËôü</th>
                            <th class="py-2 pr-4">Á´ôÈªû</th>
                            <th class="py-2 pr-4">Ê©üÁ®Æ</th>
                            <th class="py-2 pr-4">Ê¨°Êï∏</th>
                            <th class="py-2 pr-4">Êìç‰Ωú‰∫∫Âì°</th>
                            <th class="py-2 pr-4">ÂÇôË®ª</th>
                            <th class="py-2 pr-4">Êìç‰Ωú</th>
                          </tr>
                          </thead>
                          <tbody id="usageTable"></tbody>
                        </table>
                          <div id="usagePagination" class="flex mt-4 justify-center"></div>
                      </div>
                    </div>

                  </div>

                  <!-- ========================================================= -->
                  <!-- üü† Êõ¥ÊèõË®òÈåÑ TABÔºàÊîØÊè¥‰∏çÂêåÊ≤ªÂÖ∑Â±§Á¥öÔºâ -->
                  <!-- ========================================================= -->
                  <div id="logtab-replacement" class="hidden space-y-4">
                    <div class="card p-5 space-y-4">

                      <h3 class="font-semibold text-lg">Êõ¥ÊèõË®òÈåÑ</h3>


                      <!-- Êñ∞Â¢ûË°®ÂñÆ -->
                      <div class="flex gap-2 flex-wrap">
                        <button class="btn bg-pink-600 text-white hover:bg-pink-500" onclick="toggleReplaceAdd(true)">
                            Êñ∞Â¢ûÊõ¥ÊèõË®òÈåÑ
                        </button>

                        <label class="btn btn-ghost cursor-pointer">
                          <input id="replaceXlsx" type="file" accept=".xlsx" class="hidden"
                                 onchange="handleReplacementImport(this)" />
                          ÂåØÂÖ• Excel(.xlsx)
                        </label>

                        <button class="btn btn-ghost" onclick="downloadReplaceTemplate()">
                            ‰∏ãËºâÁØÑÊú¨
                        </button>
                      </div>

                      <!-- Êñ∞Â¢ûË°®ÂñÆ -->
                      <div id="replaceAddForm" class="hidden border rounded-2xl p-4 bg-pink-50 space-y-3">

                        <div class="grid md:grid-cols-5 gap-3">

                          <div class="field">
                            <label class="text-base font-semibold">Ê≤ªÂÖ∑ ID *</label>
                            <input id="replaceAddFixture" class="input" placeholder="‰æã:C-00001">
                          </div>

                            <div class="field">
                            <label class="text-base font-semibold">Êìç‰Ωú‰∫∫Âì° *</label>
                            <input id="replaceAddExecutor" class="input"  placeholder="È†êË®≠ÁôªÂÖ•ËÄÖ">
                          </div>

                          <div class="field">
                            <label class="text-base font-semibold">Êõ¥ÊèõÊó•Êúü *</label>
                            <input id="replaceAddDate" type="date" class="input" />
                          </div>

                        </div>

                            <!-- Record Level -->
                            <div class="grid md:grid-cols-6 gap-3">

                              <div class="field">
                                <label class="text-base font-semibold">Êõ¥ÊèõÂ±§Á¥ö *</label>
                                <select id="replaceAddLevel" class="input" onchange="toggleReplacementSerialInputs()">
                                  <option value="fixture">Ê≤ªÂÖ∑Datecode</option>
                                  <option value="individual">Ê≤ªÂÖ∑ÂÄãÂà•Â∫èËôü</option>
                                  <option value="batch">Ê≤ªÂÖ∑ÊâπÈáèÂ∫èËôü</option>
                                </select>
                              </div>

                                 <!-- ÂÄãÂà•Ë®òÈåÑ -->
                              <div id="replaceSerialSingleField" class="field hidden">
                                <label class="label-xs">Â∫èËôü(ÈÄóËôüÂàÜÈöî) *</label>
                                <input id="replaceAddSerials" class="input" placeholder="SN001, SN002..." />
                              </div>

                                <!-- ÊâπÈáèË®òÈåÑ -->
                                  <div id="replaceSerialBatchField" class="field hidden ">
                                      <div class="field">
                                      <label class="text-base font-semibold">Â∫èËôüËµ∑Âßã *</label>
                                      <input id="replaceAddSerialStart" class="input" placeholder="SN001">
                                  </div>
                                    <div class="field">
                                       <label class="text-base font-semibold">Â∫èËôüÁµêÂ∞æ *</label>
                                       <input id="replaceAddSerialEnd" class="input" placeholder="SN100">
                                    </div>
                                  </div>

                        </div>

                           <div class="field">
                          <label class="label-xs">ÂÇôË®ª</label>
                          <input id="replaceAddNote" class="input" />
                        </div>

                        <div class="flex justify-end gap-2">
                          <button class="btn btn-ghost" onclick="toggleReplaceAdd(false)">ÂèñÊ∂à</button>
                          <button class="btn btn-primary" onclick="submitReplacementLog()">Êèê‰∫§</button>
                        </div>

                      </div>

                        <div class="border-t border-gray-300 my-4"></div>

                        <!-- Êü•Ë©¢ÂçÄ -->
                      <div class="border rounded-2xl p-4 bg-white space-y-4">
                          <div class="flex flex-wrap items-end gap-3">
                              <div class="flex items-center gap-2">
                              <input id="replaceSearchFrom" type="date" class="input w-40" />
                              <span class="text-gray-400">‚Äî</span>
                              <input id="replaceSearchTo" type="date" class="input w-40" />
                            </div>

                            <!-- Âø´ÈÄüÊó•Êúü -->
                            <div class="flex gap-1">
                              <button class="btn btn-xs btn-outline" onclick="quickReplaceDateRange('today')">‰ªäÂ§©</button>
                              <button class="btn btn-xs btn-outline" onclick="quickReplaceDateRange('yesterday')">Êò®Â§©</button>
                              <button class="btn btn-xs btn-outline" onclick="quickReplaceDateRange('7days')">ÊúÄËøë 7 Â§©</button>

                            </div>

                          </div>

                      <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                        <div class="field">
                          <input id="replaceSearchFixture" class="input" placeholder="Ê≤ªÂÖ∑ ID" />
                        </div>

                        <div class="field">
                          <input id="replaceSearchSerial" class="input" placeholder="Ê≤ªÂÖ∑Â∫èËôü" />
                        </div>

                        <div class="field">
                          <input id="replaceSearchExecutor" class="input" placeholder="Âì°Â∑•Â∑•Ëôü" />
                        </div>

                        <div class="flex items-end">
                          <button class="btn bg-gray-400 w-full" onclick="loadReplacementLogs()">Êü•Ë©¢/Âà∑Êñ∞</button>
                        </div>

                      </div>
                      </div>

                      <!-- Êõ¥ÊèõË®òÈåÑË°®Ê†º -->
                      <div class="overflow-auto">
                        <table class="min-w-full text-sm">
                          <thead class="text-left text-gray-500">
                          <tr>
                            <th class="py-2 pr-4">Êó•Êúü</th>
                            <th class="py-2 pr-4">Ê≤ªÂÖ∑</th>
                            <th class="py-2 pr-4">Êõ¥ÊèõÂ±§Á¥ö</th>
                            <th class="py-2 pr-4">Â∫èËôü</th>
                            <th class="py-2 pr-4">ÂÇôË®ª</th>
                            <th class="py-2 pr-4">Êìç‰Ωú‰∫∫Âì°</th>
                            <th class="py-2 pr-4">Êìç‰Ωú</th>
                          </tr>
                          </thead>
                          <tbody id="replaceTable"></tbody>
                        </table>
                          <div id="replacementPagination" class="flex mt-4 justify-center"></div>
                      </div>

                    </div>
                  </div>

                </section>


                <!-- ============================================================= -->
                <!-- ÂæåËá∫ÁÆ°ÁêÜ Admin -->
                <!-- ============================================================= -->
                <section id="tab-admin" class="hidden">

                  <div class="grid grid-cols-[140px_1fr] gap-6">

                    <!-- ================= Â∑¶ÂÅ¥ÔºöÂæåÂè∞ÈÅ∏ÂñÆ ================= -->
                    <aside class="card p-3 space-y-2">

                      <button class="admin-menu btn btn-sm btn-outline w-full" data-admin-page="stations">
                        Á´ôÈªûÁÆ°ÁêÜ
                      </button>

                      <button class="admin-menu btn btn-sm btn-outline w-full" data-admin-page="fixtures">
                        Ê≤ªÂÖ∑ÁÆ°ÁêÜ
                      </button>

                      <button class="admin-menu btn btn-sm btn-outline w-full" data-admin-page="models">
                        Ê©üÁ®ÆÁÆ°ÁêÜ
                      </button>

                      <button class="admin-menu btn btn-sm btn-outline w-full" data-admin-page="owners">
                        Ë≤†Ë≤¨‰∫∫ÁÆ°ÁêÜ
                      </button>

                      <button class="admin-menu btn btn-sm btn-outline w-full" data-admin-page="systems">
                        Á≥ªÁµ±Ë®≠ÂÆö
                      </button>

                    </aside>

                    <!-- ================= Âè≥ÂÅ¥ÔºöÂÖßÂÆπÂçÄ ================= -->
                      <!-- ========== Á´ôÈªûÁÆ°ÁêÜ ========== -->
                      <div id="admin-stations" class="admin-page card p-5 space-y-4 hidden">
                          <div class="flex items-center justify-between">
                            <h3 class="font-semibold text-lg">Á´ôÈªûÁÆ°ÁêÜ</h3>
                            <button class="btn btn-primary btn-sm" onclick="stResetForm(); stOpenStationMasterModal();">Êñ∞Â¢ûÁ´ôÈªû</button>
                          </div>
                          <div class="border-t pt-3">
                            <div class="flex items-center justify-between mb-1">
                              <div class="text-sm font-semibold">Á´ôÈªûÂàóË°®(ÊêúÂ∞ãCtrl+F)</div>
                              <button class="btn btn-ghost btn-xs" onclick="stLoadStationMasterList()">Êü•Ë©¢/Âà∑Êñ∞</button>
                            </div>


                            <div class="overflow-auto border rounded-xl max-h-[70vh]">
                              <table class="min-w-full text-sm">
                                  <thead class="sticky top-0 bg-gray-50 z-10">
                                      <tr class="hover:bg-gray-50 transition">
                                        <th class="py-1 px-3 w-20 text-center align-middle">ID</th>
                                        <th class="py-1 px-3 w-20 text-center align-middle">ÂêçÁ®±</th>
                                        <th class="py-1 px-3 w-20 text-center align-middle">ÂÇôË®ª</th>
                                        <th class="py-1 px-3 w-20 text-center align-middle">Êìç‰Ωú</th>
                                      </tr>
                                    </thead>
                                <tbody id="stTable" class="divide-y divide-gray-100"></tbody>
                              </table>
                            </div>
                          </div>
                      </div>


                            <!-- ========== Ê©üÁ®ÆÁÆ°ÁêÜ ========== -->
                    <div id="admin-models" class="admin-page card p-6 space-y-4 hidden">

                      <!-- Header -->
                      <div class="flex items-center justify-between">
                        <div>
                          <h3 class="font-semibold text-lg">Ê©üÁ®ÆË≥áÊñôÁ∂≠Ë≠∑</h3>
                          <p class="text-xs text-gray-500">
                            ÁÆ°ÁêÜÊ©üÁ®ÆÔºå‰∏¶Ë®≠ÂÆöÁ´ôÈªûËàáÊ≤ªÂÖ∑ÈúÄÊ±Ç
                          </p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button class="btn btn-outline btn-sm" onclick="mmExportModelsXlsx()">ÂåØÂá∫ XLSX</button>
                            <button class="btn btn-outline btn-sm" onclick="mmDownloadModelsTemplate()">‰∏ãËºâÊ®£Êú¨</button>
                            <label class="btn btn-ghost cursor-pointer">
                                          <input
                                            id="mmImportModels"
                                            type="file"
                                            accept=".xlsx"
                                            class="hidden"
                                            onchange="mmImportModels(this.files[0])"
                                          />
                                          ÂåØÂÖ• Excel
                            </label>
                            <!-- ‚úÖ ‰∏ªÊìç‰Ωú -->
                            <button class="btn btn-primary btn-sm"
                                    onclick="mmOpenModelModal('create')">
                             Êñ∞Â¢ûÊ©üÁ®Æ
                            </button>
                        </div>
                      </div>

                      <!-- Ê©üÁ®ÆÊ∏ÖÂñÆ -->
                      <section class="border rounded-2xl p-4 space-y-3 bg-white">

                        <div class="flex items-center justify-between">
                          <div class="field w-64">
                            <input
                              id="mmSearch"
                              class="input"
                              placeholder="ÊêúÂ∞ãÊ©üÁ®Æ‰ª£Á¢º / ÂêçÁ®±"
                              onkeydown="if(event.key==='Enter'){ mmLoadModelList(); }"
                            />
                          </div>

                          <div class="flex items-center gap-3 text-xs text-gray-500">
                            ÂÖ± <span id="mmCount">0</span> Á≠Ü
                            <button class="btn btn-ghost btn-xs" onclick="mmLoadModelList()">Êü•Ë©¢/Âà∑Êñ∞</button>
                          </div>
                        </div>

                        <div class="overflow-auto border rounded-xl max-h-[70vh]">
                              <table class="min-w-full text-sm">
                              <thead class="sticky top-0 bg-gray-50 z-10">
                                  <tr class="hover:bg-gray-50 transition">
                                    <th class="py-1 px-3 w-20 text-center align-middle">Ê©üÁ®ÆID</th>
                                    <th class="py-1 px-3 w-20 text-center align-middle">Ê©üÁ®ÆÂêçÁ®±</th>
                                    <th class="py-1 px-3 w-20 text-center align-middle">ÂÇôË®ª</th>
                                    <th class="py-1 px-3 w-20 text-center align-middle">Êìç‰Ωú</th>
                                  </tr>
                                </thead>
                                <tbody id="mmTable" class="divide-y divide-gray-100"></tbody>
                              </table>
                            </div>

                      </section>
                    </div>



                      <!-- ========== Ê≤ªÂÖ∑ÁÆ°ÁêÜ ========== -->
                      <div id="admin-fixtures" class="admin-page card p-5 space-y-3 hidden">
                      <!-- ===== Header ===== -->
                      <div class="flex items-center justify-between">
                        <div>
                          <h3 class="font-semibold">Ê≤ªÂÖ∑Ë≥áÊñôÁ∂≠Ë≠∑</h3>
                          <p class="text-xs text-gray-500">
                            ÁÆ°ÁêÜÊ≤ªÂÖ∑Âü∫Êú¨Ë≥áÊñô„ÄÅÊï∏ÈáèËàáË≤†Ë≤¨‰∫∫
                          </p>
                        </div>
                            <div class="flex items-center gap-2">
                               <button class="btn btn-outline btn-sm" onclick="fxExportFixturesXlsx()">
                                ÂåØÂá∫ XLSX
                              </button>

                              <button class="btn btn-outline btn-sm" onclick="fxDownloadFixturesTemplate()">
                                ‰∏ãËºâÊ®£Êú¨
                              </button>

                              <label class="btn btn-ghost btn-sm cursor-pointer">
                                <input type="file"
                                       accept=".xlsx"
                                       class="hidden"
                                       onchange="fxImportFixtures(this.files[0])" />
                                ÂåØÂÖ• Excel
                              </label>
                            <!-- ‚úÖ ‰∏ªÊìç‰Ωú -->
                            <button class="btn btn-primary btn-sm"
                                    onclick="openFixtureModal('create')">
                             Êñ∞Â¢ûÊ≤ªÂÖ∑
                            </button>
                        </div>
                      </div>

                      <!-- ===== Êü•Ë©¢ / ÁØ©ÈÅ∏ ===== -->
                      <section class="border rounded-2xl p-3">
                        <div class="grid md:grid-cols-5 gap-3">

                          <div class="field">
                            <label class="label-xs">ÈóúÈçµÂ≠ó</label>
                            <input id="fxSearch"
                                   class="input"
                                   placeholder="Ê≤ªÂÖ∑Á∑®Ëôü / ÂêçÁ®±"
                                   onkeydown="if(event.key==='Enter'){fxPage=1;loadFixtureList();}" />
                          </div>

                          <div class="field">
                            <label class="label-xs">Ë≤†Ë≤¨‰∫∫ (owner_id)</label>
                            <input id="fxOwnerFilter"
                                   class="input"
                                   placeholder="IDÔºàÂèØÁïôÁ©∫Ôºâ"
                                   onkeydown="if(event.key==='Enter'){fxPage=1;loadFixtureList();}" />
                          </div>

                          <div class="field">
                            <label class="label-xs">ÊØèÈ†ÅÁ≠ÜÊï∏</label>
                            <select id="fxPageSize"
                                    class="input"
                                    onchange="fxPage=1;loadFixtureList();">
                              <option value="8">8</option>
                              <option value="20">20</option>
                              <option value="50">50</option>
                            </select>
                          </div>

                          <div class="field">
                          <label class="label-xs invisible">Êìç‰Ωú</label>
                          <button class="btn btn-ghost w-full"
                                  onclick="fxPage=1;loadFixtureList();">
                            Êü•Ë©¢/Âà∑Êñ∞
                          </button>
                        </div>

                        </div>
                      </section>

                      <!-- ===== ÂàóË°® / ÂàÜÈ†Å ===== -->
                      <section class="border rounded-2xl p-3 space-y-2">

                        <div class="flex items-center justify-between">
                          <div class="text-sm text-gray-600">
                            ÂÖ± <span id="fxCount">0</span> Á≠ÜÔºå
                            È°ØÁ§∫Á¨¨ <span id="fxPageNow">1</span> /
                            <span id="fxPageMax">1</span> È†ÅÔºå
                              Â∫´Â≠òË™™ÊòéÔºöËá™Ë≥º / ÂÆ¢‰æõ / Á∏ΩÊï∏
                            </div>

                          <div class="pagination flex items-center gap-2">
                            <button class="btn btn-ghost text-xs"
                                    onclick="fxPager.go('first')">¬´</button>
                            <button class="btn btn-ghost text-xs"
                                    onclick="fxPager.go('prev')">‰∏ä‰∏ÄÈ†Å</button>
                            <button class="btn btn-ghost text-xs"
                                    onclick="fxPager.go('next')">‰∏ã‰∏ÄÈ†Å</button>
                            <button class="btn btn-ghost text-xs"
                                    onclick="fxPager.go('last')">¬ª</button>
                          </div>
                        </div>

                          <div class="overflow-auto border rounded-xl max-h-[70vh]">
                            <table class="min-w-full text-sm">
                              <thead class="sticky top-0 bg-gray-50 z-10">
                              <tr class="hover:bg-gray-50 transition">
                                <th class="py-2 pr-4 text-center">Ê≤ªÂÖ∑Á∑®Ëôü</th>
                                <th class="py-2 pr-4 text-center">Ê≤ªÂÖ∑ÂêçÁ®±</th>
                                <th class="py-2 pr-4 text-center">È°ûÂûã</th>
                                <th class="py-2 pr-4 text-center">Â∫´Â≠ò</th>
                                <th class="py-2 pr-4 text-center">ÂÑ≤‰Ωç</th>
                                <th class="py-2 pr-4 text-center">Êõ¥ÊèõÈÄ±Êúü</th>
                                <th class="py-2 pr-4 text-center">Ë≤†Ë≤¨‰∫∫</th>
                                <th class="py-2 pr-4 text-center">ÂÇôË®ª</th>
                                <th class="py-2 pr-4">Êìç‰Ωú</th>
                              </tr>
                            </thead>
                            <tbody id="fxTable" class="divide-y divide-gray-100"></tbody>
                          </table>
                        </div>

                      </section>

                    </div>
                    <!-- ========== Ë≤†Ë≤¨‰∫∫ÁÆ°ÁêÜ ========== -->
                    <div id="admin-owners" class="admin-page card p-5 space-y-4 hidden">
                      <h3 class="font-semibold">Ë≤†Ë≤¨‰∫∫ÁÆ°ÁêÜ</h3>

                      <!-- ========== Inline Êñ∞Â¢ûË≤†Ë≤¨‰∫∫ ========== -->
                      <div class="border rounded-xl p-4 bg-gray-50 space-y-3">
                        <div class="font-semibold text-sm text-gray-700">Êñ∞Â¢ûË≤†Ë≤¨‰∫∫</div>
                        <div class="grid md:grid-cols-5 gap-3">
                          <!-- üîí ÂÆ¢Êà∂ÔºàËá™ÂãïÂ∏∂ÂÖ•„ÄÅ‰∏çÂèØÁ∑®ËºØÔºâ -->
                          <div class="field">
                          <label class="label-xs flex items-center justify-between">
                            <span>ÂÆ¢Êà∂</span>
                            <button
                              type="button"
                              class="text-xs text-blue-600 hover:underline"
                              onclick="refreshOwnerCustomerContext()"
                              title="ÈáçÊñ∞ËºâÂÖ•ÁõÆÂâçÂÆ¢Êà∂ÁãÄÊÖã"
                            >
                              ‚Üª ÈáçÊñ∞Êï¥ÁêÜ
                            </button>
                          </label>

                          <input
                            id="ownerCustomerDisplay"
                            class="input bg-gray-100"
                            disabled
                            placeholder="Â∞öÊú™ÈÅ∏ÊìáÂÆ¢Êà∂"
                          />
                        </div>

                          <div class="field">
                            <label class="label-xs">‰∏ªË≤†Ë≤¨‰∫∫ *</label>
                            <select id="addOwnerPrimary" class="input">
                              <option value="">Ë´ãÈÅ∏Êìá‰ΩøÁî®ËÄÖ</option>
                            </select>
                          </div>

                          <div class="field">
                            <label class="label-xs">ÂâØË≤†Ë≤¨‰∫∫</label>
                            <select id="addOwnerSecondary" class="input">
                              <option value="">ÔºàÁÑ°Ôºâ</option>
                            </select>
                          </div>

                          <div class="field md:col-span-2">
                            <label class="label-xs">ÂÇôË®ª</label>
                            <input id="addOwnerNote" class="input" />
                          </div>
                        </div>

                        <div class="flex justify-end gap-2">
                          <button class="btn btn-ghost" onclick="clearInlineOwnerForm()">
                            Ê∏ÖÁ©∫
                          </button>
                          <button class="btn btn-primary" onclick="submitInlineOwner()">
                            Êñ∞Â¢û
                          </button>
                        </div>
                      </div>

                      <!-- Êü•Ë©¢ -->
                      <div class="grid md:grid-cols-3 gap-3">
                        <div class="field md:col-span-2">
                          <label class="label-xs">ÊêúÂ∞ã</label>
                          <input
                            id="ownerSearch"
                            class="input"
                            placeholder="ÂßìÂêç"
                          />
                        </div>

                        <div class="field">
                          <label class="label-xs">ÁãÄÊÖã</label>
                          <select id="ownerFilterActive" class="input">
                            <option value="">ÂÖ®ÈÉ®</option>
                            <option value="1">ÂïüÁî®</option>
                            <option value="0">ÂÅúÁî®</option>
                          </select>
                        </div>
                      </div>

                      <!-- Ë°®Ê†º -->
                      <div class="overflow-auto border rounded-xl max-h-[70vh]">
                        <table class="min-w-full text-sm">
                          <thead class="sticky top-0 bg-gray-50 z-10">
                            <tr class="hover:bg-gray-50 transition">
                              <th class="py-2 pr-4">ID</th>
                              <th class="py-2 pr-4">‰∏ªË≤†Ë≤¨‰∫∫</th>
                              <th class="py-2 pr-4">ÂâØË≤†Ë≤¨‰∫∫</th>
                              <th class="py-2 pr-4">Êìç‰Ωú</th>
                            </tr>
                          </thead>
                          <tbody id="ownerTable" class="divide-y divide-gray-100"></tbody>
                        </table>
                        <div id="ownerPagination" class="flex gap-2 mt-3 justify-center"></div>
                      </div>
                    </div>


                      <!-- ========== Á≥ªÁµ±Ë®≠ÂÆöÔºàSMTPÔºâ ========== -->
                      <div id="admin-systems" class="admin-page card p-5 space-y-4 hidden">
                        <h3 class="font-semibold">SMTP / Á≥ªÁµ±Ë®≠ÂÆö</h3>
                            <div class="grid md:grid-cols-3 gap-3">
                              <div class="field"><label class="label-xs">Email</label><input id="smtpEmail" class="input" placeholder="ÈÄöÁü•ÂØÑÈÄÅ Email"/></div>
                              <div class="field"><label class="label-xs">Â§ñÈÄÅÈÉµ‰ª∂‰º∫ÊúçÂô®ÂêçÁ®± (SMTP)</label><input id="smtpHost" class="input" placeholder="smtp.example.com"/></div>
                              <div class="field"><label class="label-xs">Âü†Ëôü (Port)</label><input id="smtpPort" class="input" placeholder="587"/></div>
                              <div class="field"><label class="label-xs">Ë™çË≠âÁãÄÊÖã</label>
                                <select id="smtpAuthState" class="input">
                                  <option>Êú™Ë™çË≠â</option><option>Â∑≤Ë™çË≠â</option>
                                </select>
                              </div>
                              <div class="field"><label class="label-xs">Ë™çË≠âÂ∏≥Ëôü</label><input id="smtpUser" class="input" /></div>
                              <div class="field"><label class="label-xs">Ë™çË≠âÂØÜÁ¢º</label><input id="smtpPass" type="password" class="input" /></div>
                              <div class="field"><label class="label-xs">ÂØÑ‰ª∂ËÄÖÂêçÁ®±</label><input id="smtpSenderName" class="input" /></div>
                              <div class="field"><label class="label-xs">ÂØÑ‰ª∂ËÄÖ‰ø°ÁÆ±</label><input id="smtpSenderMail" type="email" class="input" /></div>
                            </div>
                            <div class="flex gap-2">
                              <button class="btn btn-primary" onclick="toast('Â∑≤ÂÑ≤Â≠ò SMTP(Ê®°Êì¨)')">ÂÑ≤Â≠ò</button>
                              <button class="btn btn-ghost" onclick="toast('Ê∏¨Ë©¶ÂØÑ‰ø°(Ê®°Êì¨)')">Ê∏¨Ë©¶ÂØÑ‰ø°</button>
                            </div>
                      </div>

                    </div>
                  </div>

                  <!-- ================= Modal ÂçÄÔºà‰∏ÄÂÆöË¶ÅÂú®ÈÄôÂ±§Ôºâ ================= -->

                  <!-- ================= Ê≤ªÂÖ∑ Êñ∞Â¢û / Á∑®ËºØ Modal ================= -->
                    <div id="fixtureModal"
                         class="fixed inset-0 bg-black/30 backdrop-blur-sm items-center justify-center hidden z-40">

                      <div class="bg-white rounded-2xl shadow-xl max-w-3xl w-full mx-4 p-5 space-y-4">

                        <!-- ===== Header ===== -->
                        <div class="flex items-center justify-between">
                          <div>
                            <h3 id="fixtureModalTitle" class="font-semibold text-lg">
                              Êñ∞Â¢ûÊ≤ªÂÖ∑
                            </h3>
                            <p class="text-xs text-gray-500">
                              Âª∫Á´ãÊàñ‰øÆÊîπÊ≤ªÂÖ∑ÁöÑÂü∫Êú¨Ë≥áÊñôËàá‰ΩøÁî®Ë®≠ÂÆö
                            </p>
                          </div>
                          <button class="btn btn-ghost text-sm" onclick="closeFixtureModal()">‚úï</button>
                        </div>

                        <!-- ===== Form ===== -->
                        <form id="fixtureForm"
                              class="space-y-4"
                              onsubmit="submitFixtureForm(event)">

                          <!-- === Âü∫Êú¨Ë≥áÊñô === -->
                          <section class="space-y-2">
                            <h4 class="text-sm font-semibold text-gray-700">Âü∫Êú¨Ë≥áÊñô</h4>

                            <div class="grid md:grid-cols-3 gap-3">
                              <div class="field">
                                <label class="label-xs">Ê≤ªÂÖ∑Á∑®Ëôü (fixture_id)</label>
                                <input id="fmFixtureId" class="input" placeholder="L-00017" />
                              </div>
                              <div class="field">
                                <label class="label-xs">Ê≤ªÂÖ∑ÂêçÁ®±</label>
                                <input id="fmFixtureName" class="input" placeholder="‰∏ªÊùøÊ∏¨Ë©¶Ê≤ªÂÖ∑ A" />
                              </div>
                              <div class="field">
                                <label class="label-xs">Ê≤ªÂÖ∑È°ûÂûã</label>
                                <input id="fmFixtureType" class="input" placeholder="Ê∏¨Ë©¶Ê≤ªÂÖ∑" />
                              </div>
                            </div>

                            <div class="grid md:grid-cols-4 gap-3">
                              <div class="field">
                                <label class="label-xs">Â∫èËôü (serial_number)</label>
                                <input id="fmSerialNumber" class="input" placeholder="SN2025..." />
                              </div>
                              <div class="field">
                                <label class="label-xs">ÂÑ≤Â≠ò‰ΩçÁΩÆ</label>
                                <input id="fmStorage" class="input" placeholder="ÂÄâÂ∫´ A-01" />
                              </div>
                            </div>
                          </section>

                          <!-- === ‰ΩøÁî® / ÁãÄÊÖãË®≠ÂÆö === -->
                          <section class="space-y-2">
                            <h4 class="text-sm font-semibold text-gray-700">‰ΩøÁî®</h4>

                            <div class="grid md:grid-cols-4 gap-3">
                              <div class="field">
                                <label class="label-xs">Êõ¥ÊèõÈÄ±Êúü (Êï∏ÂÄº)</label>
                                <input id="fmCycle"
                                       type="number"
                                       min="0"
                                       step="0.01"
                                       class="input" />
                              </div>

                              <div class="field">
                                <label class="label-xs">ÈÄ±ÊúüÂñÆ‰Ωç</label>
                                <select id="fmCycleUnit" class="input">
                                  <option value="uses">‰ΩøÁî®Ê¨°Êï∏</option>
                                  <option value="days">Â§©Êï∏</option>
                                  <option value="none">ÁÑ°</option>
                                </select>
                              </div>

                              <div class="field">
                                <label class="label-xs">Ë≤†Ë≤¨‰∫∫ ID (owner_id)</label>
                                <input id="fmOwnerId" type="number" min="0" class="input" />
                              </div>
                            </div>
                          </section>

                          <!-- === ÂÇôË®ª === -->
                          <section class="space-y-2">
                            <h4 class="text-sm font-semibold text-gray-700">ÂÇôË®ª</h4>
                            <div class="field">
                              <textarea id="fmNote" class="input" rows="2"></textarea>
                            </div>
                          </section>

                          <!-- ===== Actions ===== -->
                          <div class="flex items-center justify-end gap-2 pt-3 border-t">
                            <button type="button"
                                    class="btn btn-ghost"
                                    onclick="closeFixtureModal()">
                              ÂèñÊ∂à
                            </button>
                            <button type="submit" class="btn btn-primary">
                              ÂÑ≤Â≠ò
                            </button>
                          </div>

                        </form>
                      </div>
                    </div>


                    <!-- ========== Á∑®ËºØË≤†Ë≤¨‰∫∫ Modal ========== -->
                    <div
                      id="ownerEditModal"
                      class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50"
                    >
                      <div class="bg-white rounded-xl w-full max-w-lg p-6 space-y-4">
                        <h3 class="font-semibold text-lg">Á∑®ËºØË≤†Ë≤¨‰∫∫</h3>
                        <div class="field">
                          <label class="label-xs">ÂÆ¢Êà∂</label>
                          <input
                            id="editOwnerCustomerDisplay"
                            class="input bg-gray-100"
                            disabled
                          />
                        </div>
                        <!-- hidden id -->
                        <input type="hidden" id="editOwnerId" />

                        <div class="grid grid-cols-2 gap-3">
                          <div class="field col-span-2">
                            <label class="label-xs">‰∏ªË≤†Ë≤¨‰∫∫ *</label>
                            <select id="editOwnerPrimary" class="input">
                              <option value="">Ë´ãÈÅ∏Êìá‰ΩøÁî®ËÄÖ</option>
                            </select>
                          </div>

                          <div class="field col-span-2">
                            <label class="label-xs">ÂâØË≤†Ë≤¨‰∫∫</label>
                            <select id="editOwnerSecondary" class="input">
                              <option value="">ÔºàÁÑ°Ôºâ</option>
                            </select>
                          </div>

                          <div class="field col-span-2">
                            <label class="label-xs">Email *</label>
                            <input id="editOwnerEmail" class="input" />
                          </div>

                          <div class="field col-span-2">
                            <label class="label-xs">ÂÇôË®ª</label>
                            <input id="editOwnerNote" class="input" />
                          </div>
                        </div>

                        <div class="flex justify-end gap-2 pt-2">
                          <button class="btn btn-ghost" onclick="closeOwnerEdit()">ÂèñÊ∂à</button>
                          <button class="btn btn-primary" onclick="submitOwnerEdit()">ÂÑ≤Â≠ò</button>
                        </div>
                      </div>
                    </div>


                  <!-- Ê©üÁ®Æ Modal -->
                  <div id="mmModelModal" class="fixed inset-0 bg-black/30 backdrop-blur-sm items-center justify-center hidden z-40">
                    <div class="bg-white rounded-2xl shadow-xl max-w-lg w-full mx-4 p-5 space-y-4">
                      <div class="flex items-center justify-between">
                        <h3 id="mmModelModalTitle" class="font-semibold text-lg">Êñ∞Â¢ûÊ©üÁ®Æ</h3>
                        <button class="btn btn-ghost text-sm" onclick="mmCloseModelModal()">‚úï</button>
                      </div>
                      <form id="mmModelForm" class="space-y-3" onsubmit="mmSubmitModelForm(event)">
                        <div class="grid md:grid-cols-2 gap-3">
                          <div class="field">
                            <label class="label-xs">Ê©üÁ®Æ‰ª£Á¢º (model_id)</label>
                            <input id="mmModelId" class="input" placeholder="Â¶Ç EDS-518A-SS-SC-80" />
                          </div>
                          <div class="field">
                            <label class="label-xs">Ê©üÁ®ÆÂêçÁ®±</label>
                            <input id="mmModelName" class="input" placeholder="Ê©üÁ®ÆÈ°ØÁ§∫ÂêçÁ®±" />
                          </div>
                        </div>
                        <div class="field">
                          <label class="label-xs">ÂÇôË®ª</label>
                          <textarea id="mmModelNote" class="input" rows="2"></textarea>
                        </div>
                        <div class="flex items-center justify-end gap-2 pt-2 border-t">
                          <button type="button" class="btn btn-ghost" onclick="mmCloseModelModal()">ÂèñÊ∂à</button>
                          <button type="button" class="btn btn-primary" onclick="submitModelForm()">ÂÑ≤Â≠ò</button>
                        </div>
                      </form>
                    </div>
                  </div>

                    <!-- Á´ôÈªûÊñ∞Â¢û / Á∑®ËºØ Modal -->
                    <div id="stationModal"
                         class="fixed inset-0 bg-black/30 backdrop-blur-sm hidden z-50 flex items-center justify-center">

                      <div class="bg-white rounded-2xl shadow-xl w-full max-w-xl p-5 space-y-4">
                        <div class="flex items-center justify-between">
                          <h3 id="stationModalTitle" class="font-semibold text-lg">Êñ∞Â¢ûÁ´ôÈªû</h3>
                          <button class="btn btn-ghost btn-sm" onclick="closeStationModal()">‚úï</button>
                        </div>

                        <div class="grid md:grid-cols-2 gap-3">
                          <div class="field">
                            <label class="label-xs">Á´ôÈªû‰ª£Á¢º</label>
                            <input id="stCode" class="input" />
                          </div>

                          <div class="field">
                            <label class="label-xs">Á´ôÈªûÂêçÁ®±</label>
                            <input id="stName" class="input" />
                          </div>

                          <div class="field md:col-span-2">
                            <label class="label-xs">ÂÇôË®ª</label>
                            <input id="stNote" class="input" />
                          </div>
                        </div>

                        <div class="flex justify-end gap-2 pt-3">
                          <button class="btn btn-ghost btn-sm" onclick="closeStationModal()">ÂèñÊ∂à</button>
                          <button class="btn btn-primary btn-sm" onclick="stSubmitForm()">ÂÑ≤Â≠ò</button>
                        </div>
                      </div>
                    </div>

                    <!-- ========== Ê©üÁ®ÆÁ∑®ËºØ Modal ========== -->
                    <div id="modelEditModal"
                         class="fixed inset-0 z-50 bg-black/40 hidden">

                      <div class="absolute inset-6 bg-white rounded-2xl shadow-xl
                                  flex flex-col">

                        <!-- Header -->
                        <div class="px-6 py-4 border-b flex items-center justify-between">
                          <div>
                            <h3 class="font-semibold text-lg">
                              Á∑®ËºØÊ©üÁ®Æ
                              <span id="meModelId" class="text-sm text-gray-500"></span>
                            </h3>
                            <p class="text-xs text-gray-500">
                              Ë®≠ÂÆöÁ´ôÈªûÁ∂ÅÂÆöËàáÊ≤ªÂÖ∑ÈúÄÊ±Ç
                            </p>
                          </div>
                          <button class="btn btn-ghost" onclick="closeModelEditModal()">‚úï</button>
                        </div>

                        <!-- Content -->
                        <div class="flex-1 grid grid-cols-2 gap-6 p-6 overflow-hidden">

                          <!-- Â∑¶ÔºöÁ´ôÈªûÁ∂ÅÂÆö -->
                          <section class="border rounded-xl p-4 overflow-auto">
                            <div class="flex items-center justify-between mb-2">
                              <h4 class="font-semibold">Á´ôÈªûÁ∂ÅÂÆö</h4>
                              <button class="btn btn-ghost btn-xs" onclick="meReloadStations()">
                                Êü•Ë©¢/Âà∑Êñ∞
                              </button>
                            </div>

                            <div id="meStationPanel">
                              <!-- JS renderÔºöÂ∑≤Á∂Å / ÂèØÁ∂ÅÁ´ôÈªû -->
                            </div>
                          </section>

                          <!-- Âè≥ÔºöÊ≤ªÂÖ∑ÈúÄÊ±Ç -->
                          <section class="border rounded-xl p-4 overflow-auto">
                            <div class="mb-2">
                              <h4 class="font-semibold">
                                Ê≤ªÂÖ∑ÈúÄÊ±Ç
                                <span id="meSelectedStationLabel"
                                      class="text-xs text-gray-500"></span>
                              </h4>
                            </div>

                            <div id="meFixturePanel">
                              <div class="text-xs text-gray-400">
                                Ë´ãÂÖàÂú®Â∑¶ÂÅ¥ÈÅ∏Êìá‰∏ÄÂÄãÁ´ôÈªû
                              </div>
                            </div>
                          </section>

                        </div>

                        <!-- Footer -->
                        <div class="px-6 py-4 border-t text-right">
                          <button class="btn btn-outline" onclick="closeModelEditModal()">ÈóúÈñâ</button>
                        </div>

                      </div>
                    </div>

                </section>


                <!-- Â∫èËôüÂ±•Ê≠∑ Drawer -->
                    <div id="serialDetailOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
                    <div id="serialDetailDrawer"
                         class="fixed top-0 right-0 h-full w-full md:w-2/3 lg:w-1/2 bg-white shadow-xl z-50 transform translate-x-full transition-transform duration-300 overflow-y-auto">

                      <div class="p-6 space-y-6">
                        <!-- Header -->
                        <div class="flex justify-between items-center border-b pb-4">
                          <h2 class="text-2xl font-bold">Â∫èËôüÂ±•Ê≠∑</h2>
                          <button onclick="closeSerialDetailDrawer()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                          </button>
                        </div>

                        <!-- Â∫èËôüË≥áË®ä -->
                        <div class="space-y-3">
                          <h3 class="font-semibold text-lg">Â∫èËôüË≥áË®ä</h3>
                          <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                              <span class="text-gray-500">Â∫èËôüÔºö</span>
                              <span id="serialDetailTitle" class="font-mono font-semibold">-</span>
                            </div>
                            <div>
                              <span class="text-gray-500">Ê≤ªÂÖ∑ IDÔºö</span>
                              <span id="sdFixture">-</span>
                            </div>
                            <div>
                              <span class="text-gray-500">ÁãÄÊÖãÔºö</span>
                              <span id="sdStatus">-</span>
                            </div>
                            <div>
                              <span class="text-gray-500">‰æÜÊ∫êÔºö</span>
                              <span id="sdSource">-</span>
                            </div>
                            <div>
                              <span class="text-gray-500">Á∏Ω‰ΩøÁî®Ê¨°Êï∏Ôºö</span>
                              <span id="sdTotalUses">-</span>
                            </div>
                          </div>
                        </div>

                        <!-- Êî∂ÈÄÄÊñôË®òÈåÑ -->
                        <div class="space-y-3">
                          <h3 class="font-semibold text-lg">Êî∂ÈÄÄÊñôË®òÈåÑ</h3>
                          <div class="overflow-auto">
                            <table class="min-w-full text-sm">
                              <thead class="text-left text-gray-500">
                                <tr>
                                  <th class="py-2 pr-4">ÊôÇÈñì</th>
                                  <th class="py-2 pr-4">È°ûÂûã</th>
                                  <th class="py-2 pr-4">ÂñÆËôü</th>
                                  <th class="py-2 pr-4">Êìç‰Ωú‰∫∫Âì°</th>
                                </tr>
                              </thead>
                              <tbody id="sdTransactions"></tbody>
                            </table>
                          </div>
                        </div>

                        <!-- ‰ΩøÁî®Ë®òÈåÑ -->
                        <div class="space-y-3">
                          <h3 class="font-semibold text-lg">‰ΩøÁî®Ë®òÈåÑ</h3>
                          <div class="overflow-auto">
                            <table class="min-w-full text-sm">
                              <thead class="text-left text-gray-500">
                                <tr>
                                  <th class="py-2 pr-4">‰ΩøÁî®ÊôÇÈñì</th>
                                  <th class="py-2 pr-4">Ê©üÂûã</th>
                                  <th class="py-2 pr-4">Á´ôÈªû</th>
                                  <th class="py-2 pr-4">‰ΩøÁî®Ê¨°Êï∏</th>
                                </tr>
                              </thead>
                              <tbody id="sdUsages"></tbody>
                            </table>
                          </div>
                        </div>

                        <!-- Êõ¥ÊèõË®òÈåÑ -->
                        <div class="space-y-3">
                          <h3 class="font-semibold text-lg">Êõ¥ÊèõË®òÈåÑ</h3>
                          <div class="overflow-auto">
                            <table class="min-w-full text-sm">
                              <thead class="text-left text-gray-500">
                                <tr>
                                  <th class="py-2 pr-4">Êõ¥ÊèõÊôÇÈñì</th>
                                  <th class="py-2 pr-4">Êõ¥ÊèõÂâç‰ΩøÁî®Ê¨°Êï∏</th>
                                  <th class="py-2 pr-4">Êõ¥ÊèõÂæå‰ΩøÁî®Ê¨°Êï∏</th>
                                </tr>
                              </thead>
                              <tbody id="sdReplacements"></tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>

                <!-- Êñ∞Â¢û / Á∑®ËºØÊ≤ªÂÖ∑ÈúÄÊ±Ç ModalÔºàÂÖ±Áî®Ôºâ -->
                    <div id="requirementModal"
                         class="fixed inset-0 bg-black bg-opacity-40 hidden items-center justify-center z-50"
                         style="display:none;">
                      <div class="bg-white rounded-xl shadow-xl p-6 w-[400px] space-y-4">

                        <h3 id="reqModalTitle" class="text-lg font-semibold">Êñ∞Â¢ûÊ≤ªÂÖ∑ÈúÄÊ±Ç</h3>

                        <!-- Ê®°ÂºèÔºöcreate / edit -->
                        <input type="hidden" id="reqModalMode" />
                        <input type="hidden" id="reqModalReqId" />

                        <!-- create ÊâçÈ°ØÁ§∫ -->
                        <div id="reqModalFixtureBlock">
                          <label class="text-sm font-medium">Ê≤ªÂÖ∑Á∑®Ëôü</label>
                          <input id="reqModalFixtureId" class="input w-full" placeholder="‰æãÂ¶ÇÔºöFIX-001" />
                        </div>

                        <div>
                          <label class="text-sm font-medium">ÈúÄÊ±ÇÊï∏Èáè</label>
                          <input id="reqModalRequiredQty" type="number" class="input w-full" />
                        </div>

                        <div>
                          <label class="text-sm font-medium">ÂÇôË®ª</label>
                          <textarea id="reqModalNote" class="input w-full" rows="2"></textarea>
                        </div>

                        <div class="flex justify-end gap-3">
                          <button class="btn btn-ghost" onclick="closeRequirementModal()">ÂèñÊ∂à</button>
                          <button class="btn btn-primary" onclick="submitRequirementModal()">Á¢∫Ë™ç</button>
                        </div>

                      </div>
                    </div>


                <!-- Fixture Detail Drawer -->
                    <div id="fixtureDetailDrawer"
                              class="fixed top-0 right-0 w-full md:w-2/3 lg:w-1/2 h-full bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-50 overflow-y-auto">

                      <div class="flex justify-between items-center p-4 border-b">
                        <h2 class="text-lg font-semibold">Ê≤ªÂÖ∑Ë©≥ÊÉÖ</h2>
                        <button onclick="closeFixtureDetail()" class="text-gray-500 hover:text-black">
                          ‚úï
                        </button>
                      </div>

                      <div id="fixtureDetailContent" class="p-4 overflow-y-auto h-[calc(100%-60px)]">
                        <!-- JS render content here -->
                      </div>

                    </div>


                <!-- Model Detail Drawer -->
                    <div id="modelDetailDrawer"
                         class="fixed right-0 top-0 h-full w-[480px] bg-white shadow-xl transform translate-x-full transition-all duration-300 z-50">

                      <div class="flex justify-between items-center p-4 border-b">
                        <h2 class="text-lg font-semibold">Ê©üÁ®ÆË©≥ÊÉÖ</h2>
                        <button onclick="closeModelDetail()" class="text-gray-500 hover:text-black">‚úï</button>
                      </div>

                      <div id="modelDetailContent" class="p-4 overflow-y-auto h-[calc(100%-60px)] text-sm space-y-6">

                        <!-- JS ÊúÉÂ°ûÂÖßÂÆπ -->

                      </div>

                    </div>


                <!-- Toast -->
                    <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden">
                    <div class="bg-gray-900 text-white px-4 py-2 rounded-xl shadow-lg">Ë®äÊÅØ</div>
                  </div>

              </main>

        <!-- ================================ -->
        <!-- ÂºïÂÖ• JavaScript -->
        <!-- ================================ -->

        <!-- Excel ÂåØÂÖ•ÔºàÂøÖÈ†àÊúÄ‰∏äÔºå‰ª•‰æøÂæåÁ∫åÊâÄÊúâÂåØÂÖ•ÂäüËÉΩ‰ΩøÁî®Ôºâ -->
            <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

        <!-- API Âü∫Êú¨Ë®≠ÂÆöÔºåÂ¶Ç api()„ÄÅAPI_PREFIX„ÄÅToken Ê≥®ÂÖ•„ÄÅ401 ËôïÁêÜ -->
            <script src="/js/api/api-config.js"></script>

        <!-- Ë™çË≠â APIÔºö/auth/login, /auth/me -->
            <script src="/js/api/api-auth.js"></script>

        <!-- Ë™çË≠âËàáÁôªÂÖ• UI ÊéßÂà∂ÔºàloginModal, doLogin, loadCurrentUserÔºâ -->
            <script src="/js/app/app-auth.js"></script>
            <script src="/js/app/app-admin.js"></script>
            <script src="/js/app/app-dashboard.js"></script>

        <!-- ‰∏ªÊéßÂà∂ÔºàÈ†ÅÈù¢ÂàáÊèõ/ÂàùÂßãÂåñÔºâ         -->
            <script src="/js/app/app-main.js"></script>

        <!-- ÂÖ±Áî®Â∑•ÂÖ∑ÔºàÂ¶ÇÊûú‰Ω†ÊúâÂú®Áî®Â∞±‰øùÁïôÔºâ -->
            <script src="/js/utils/storage.js"></script>
            <script src="/js/utils/utils.js"></script>
            <script src="/js/utils/calculations.js"></script>
            <script src="/js/utils/ui-render.js"></script>

        <!-- Shared Modules -->
            <script src="/js/shared/serial-utils.js"></script>
            <script src="/js/shared/export-tools.js"></script>
            <script src="/js/shared/ui-table.js"></script>
            <script src="/js/shared/ui-pagination.js"></script>

        <!-- Âü∫Á§éË≥áÊñôÔºöÂÆ¢Êà∂ / Ë≤†Ë≤¨‰∫∫ / Á´ôÈªû   -->

            <!-- ÂÆ¢Êà∂ -->
            <script src="/js/app/customer-context.js"></script>

            <!-- Ë≤†Ë≤¨‰∫∫ -->
            <script src="/js/api/api-owners.js"></script>
            <script src="/js/app/app-owners.js"></script>

            <!-- Á´ôÈªû -->
            <script src="/js/api/api-stations.js"></script>
            <script src="/js/app/app-stations.js"></script>

            <!-- Ê©üÁ®Æ -->
            <script src="/js/api/api-machine-models.js"></script>
            <script src="/js/api/api-model-detail.js"></script>
            <script src="/js/app/app-machine-models.js"></script>

            <!-- Êü•Ë©¢ -->
            <script src="/js/app/app-query.js"></script>
            <script src="/js/app/app-transactions-view.js"></script>

            <!-- Ê≤ªÂÖ∑‰∏ªÊ™î -->
            <script src="/js/api/api-fixtures.js"></script>
            <script src="/js/app/app-fixtures.js"></script>

            <!-- Êî∂/ÈÄÄÊñô -->
            <script src="/js/api/api-transactions.js"></script>
            <script src="/js/app/app-transactions.js"></script>

        <!-- ‰ΩøÁî®Á¥ÄÈåÑ / Êõ¥ÊèõÁ¥ÄÈåÑ  -->
            <script src="/js/api/api-usage.js"></script>
            <script src="/js/app/app-usage.js"></script>
            <script src="/js/api/api-replacement.js"></script>
            <script src="/js/app/app-replacement.js"></script>

        <!-- üî¢ Â∫èËôüÂ∑•ÂÖ∑ / Áµ±Ë®à  -->
            <script src="/js/api/api-serials.js"></script>
            <script src="/js/app/app-serials.js"></script>
            <script src="/js/api/api-stats.js"></script>
            <script src="/js/api/api-inventory.js"></script>
            <script src="/js/app/app-inventory.js"></script>
            <script src="/js/app/app-stats.js"></script>

  </body>
</html>